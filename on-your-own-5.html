<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 On your own | An Introduction to Camera Trap Data Management and Analysis in R</title>
  <meta name="description" content="Materials for the three day camera trap data management and analysis course" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 On your own | An Introduction to Camera Trap Data Management and Analysis in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Materials for the three day camera trap data management and analysis course" />
  <meta name="github-repo" content="WildCoLab/Introduction-to-Camera-Trap-Data-Management-and-Analysis-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 On your own | An Introduction to Camera Trap Data Management and Analysis in R" />
  
  <meta name="twitter:description" content="Materials for the three day camera trap data management and analysis course" />
  

<meta name="author" content="Christopher Beirne, the Wildlife Coexistence Lab, UBC, and the WildCam Network" />


<meta name="date" content="2025-01-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="behavior.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WildCo Data Analysis Intro</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#ethos"><i class="fa fa-check"></i><b>1.1</b> Ethos</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#what-this-course-is"><i class="fa fa-check"></i><b>1.2</b> What this course is</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#what-this-course-is-not"><i class="fa fa-check"></i><b>1.3</b> What this course is not</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.4</b> How to use this book</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#get-in-touch"><i class="fa fa-check"></i><b>1.5</b> Get in touch</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#cite-the-course"><i class="fa fa-check"></i><b>1.6</b> Cite the course</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prep.html"><a href="prep.html"><i class="fa fa-check"></i><b>2</b> Preparing for the course</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prep.html"><a href="prep.html#install-r"><i class="fa fa-check"></i><b>2.1</b> Install R</a></li>
<li class="chapter" data-level="2.2" data-path="prep.html"><a href="prep.html#install-rstudio"><i class="fa fa-check"></i><b>2.2</b> Install RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="prep.html"><a href="prep.html#install-the-required-packages"><i class="fa fa-check"></i><b>2.3</b> Install the required packages</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="prep.html"><a href="prep.html#cran-packages"><i class="fa fa-check"></i><b>2.3.1</b> CRAN packages</a></li>
<li class="chapter" data-level="2.3.2" data-path="prep.html"><a href="prep.html#other-packages"><i class="fa fa-check"></i><b>2.3.2</b> Other packages</a></li>
<li class="chapter" data-level="2.3.3" data-path="prep.html"><a href="prep.html#an-earthdata-server-account"><i class="fa fa-check"></i><b>2.3.3</b> An Earthdata Server account</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="prep.html"><a href="prep.html#create-an-r-project"><i class="fa fa-check"></i><b>2.4</b> Create an R project</a></li>
<li class="chapter" data-level="2.5" data-path="prep.html"><a href="prep.html#download-the-data-files"><i class="fa fa-check"></i><b>2.5</b> Download the data files</a></li>
<li class="chapter" data-level="2.6" data-path="prep.html"><a href="prep.html#the-example-datasets"><i class="fa fa-check"></i><b>2.6</b> The example datasets</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="prep.html"><a href="prep.html#example_data"><i class="fa fa-check"></i><b>2.6.1</b> example_data</a></li>
<li class="chapter" data-level="2.6.2" data-path="prep.html"><a href="prep.html#your_data"><i class="fa fa-check"></i><b>2.6.2</b> your_data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="prep.html"><a href="prep.html#practise-before-the-course"><i class="fa fa-check"></i><b>2.7</b> Practise before the course</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html"><i class="fa fa-check"></i><b>3</b> Preprocessing and labelling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#data-storage"><i class="fa fa-check"></i><b>3.1</b> Data storage</a></li>
<li class="chapter" data-level="3.2" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#preprocessing"><i class="fa fa-check"></i><b>3.2</b> Preprocessing</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#renaming"><i class="fa fa-check"></i><b>3.2.1</b> Renaming</a></li>
<li class="chapter" data-level="3.2.2" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#automated-labelers"><i class="fa fa-check"></i><b>3.2.2</b> Automated Labelers</a></li>
<li class="chapter" data-level="3.2.3" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#sensitive-images"><i class="fa fa-check"></i><b>3.2.3</b> Sensitive images</a></li>
<li class="chapter" data-level="3.2.4" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#timelapse-extraction"><i class="fa fa-check"></i><b>3.2.4</b> Timelapse extraction</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#labelling"><i class="fa fa-check"></i><b>3.3</b> Labelling</a></li>
<li class="chapter" data-level="3.4" data-path="preprocessing-and-labelling.html"><a href="preprocessing-and-labelling.html#end-dates-and-outages"><i class="fa fa-check"></i><b>3.4</b> End dates and outages</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="standard.html"><a href="standard.html"><i class="fa fa-check"></i><b>4</b> Metadata standardisation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="standard.html"><a href="standard.html#the-wildlife-insights-minimum-metadata-standards"><i class="fa fa-check"></i><b>4.1</b> The Wildlife Insights Minimum Metadata Standards</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="standard.html"><a href="standard.html#project-data"><i class="fa fa-check"></i><b>4.1.1</b> Project data</a></li>
<li class="chapter" data-level="4.1.2" data-path="standard.html"><a href="standard.html#image-data"><i class="fa fa-check"></i><b>4.1.2</b> Image data</a></li>
<li class="chapter" data-level="4.1.3" data-path="standard.html"><a href="standard.html#deployment-data"><i class="fa fa-check"></i><b>4.1.3</b> Deployment data</a></li>
<li class="chapter" data-level="4.1.4" data-path="standard.html"><a href="standard.html#camera-inventory"><i class="fa fa-check"></i><b>4.1.4</b> Camera inventory</a></li>
<li class="chapter" data-level="4.1.5" data-path="standard.html"><a href="standard.html#important-note"><i class="fa fa-check"></i><b>4.1.5</b> Important note</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="error-checking.html"><a href="error-checking.html"><i class="fa fa-check"></i><b>5</b> Error checking</a>
<ul>
<li class="chapter" data-level="5.1" data-path="error-checking.html"><a href="error-checking.html#standardised-exploration-script"><i class="fa fa-check"></i><b>5.1</b> Standardised exploration script</a></li>
<li class="chapter" data-level="5.2" data-path="error-checking.html"><a href="error-checking.html#adding-a-sampling-site-location-column-to-the-image-data"><i class="fa fa-check"></i><b>5.2</b> Adding a sampling site location column to the image data</a></li>
<li class="chapter" data-level="5.3" data-path="error-checking.html"><a href="error-checking.html#formatting-dates"><i class="fa fa-check"></i><b>5.3</b> Formatting dates</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="error-checking.html"><a href="error-checking.html#skill-check-lubridate"><i class="fa fa-check"></i><b>5.3.1</b> Skill check: <code>lubridate</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="error-checking.html"><a href="error-checking.html#deployment-dates"><i class="fa fa-check"></i><b>5.3.2</b> Deployment dates</a></li>
<li class="chapter" data-level="5.3.3" data-path="error-checking.html"><a href="error-checking.html#image-dates"><i class="fa fa-check"></i><b>5.3.3</b> Image dates</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="error-checking.html"><a href="error-checking.html#basic-trapping-summaries"><i class="fa fa-check"></i><b>5.4</b> Basic trapping summaries</a></li>
<li class="chapter" data-level="5.5" data-path="error-checking.html"><a href="error-checking.html#error-checks"><i class="fa fa-check"></i><b>5.5</b> Error checks</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="error-checking.html"><a href="error-checking.html#camera-locations"><i class="fa fa-check"></i><b>5.5.1</b> Camera locations</a></li>
<li class="chapter" data-level="5.5.2" data-path="error-checking.html"><a href="error-checking.html#camera-activity-checks"><i class="fa fa-check"></i><b>5.5.2</b> Camera activity checks</a></li>
<li class="chapter" data-level="5.5.3" data-path="error-checking.html"><a href="error-checking.html#detection-check"><i class="fa fa-check"></i><b>5.5.3</b> Detection check</a></li>
<li class="chapter" data-level="5.5.4" data-path="error-checking.html"><a href="error-checking.html#taxonomy-check"><i class="fa fa-check"></i><b>5.5.4</b> Taxonomy check</a></li>
<li class="chapter" data-level="5.5.5" data-path="error-checking.html"><a href="error-checking.html#skill-check-taxize-package"><i class="fa fa-check"></i><b>5.5.5</b> Skill Check: Taxize package</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="error-checking.html"><a href="error-checking.html#diel-activity-check"><i class="fa fa-check"></i><b>5.6</b> Diel activity check</a></li>
<li class="chapter" data-level="5.7" data-path="error-checking.html"><a href="error-checking.html#conclusion"><i class="fa fa-check"></i><b>5.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-creation.html"><a href="data-creation.html"><i class="fa fa-check"></i><b>6</b> Analysis data creation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-creation.html"><a href="data-creation.html#common-analysis-data-formats"><i class="fa fa-check"></i><b>6.1</b> Common analysis data formats</a></li>
<li class="chapter" data-level="6.2" data-path="data-creation.html"><a href="data-creation.html#independent-detections"><i class="fa fa-check"></i><b>6.2</b> Independent detections</a></li>
<li class="chapter" data-level="6.3" data-path="data-creation.html"><a href="data-creation.html#effort-look-up"><i class="fa fa-check"></i><b>6.3</b> Effort look-up</a></li>
<li class="chapter" data-level="6.4" data-path="data-creation.html"><a href="data-creation.html#observations-by-time-interval"><i class="fa fa-check"></i><b>6.4</b> Observations by time interval</a></li>
<li class="chapter" data-level="6.5" data-path="data-creation.html"><a href="data-creation.html#our-data"><i class="fa fa-check"></i><b>6.5</b> Our data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-creation.html"><a href="data-creation.html#filter-to-target-species"><i class="fa fa-check"></i><b>6.5.1</b> Filter to target species</a></li>
<li class="chapter" data-level="6.5.2" data-path="data-creation.html"><a href="data-creation.html#create-a-daily-camera-activity-lookup"><i class="fa fa-check"></i><b>6.5.2</b> Create a daily camera activity lookup</a></li>
<li class="chapter" data-level="6.5.3" data-path="data-creation.html"><a href="data-creation.html#determine-independent-camera-detections"><i class="fa fa-check"></i><b>6.5.3</b> Determine ‘independent’ camera detections</a></li>
<li class="chapter" data-level="6.5.4" data-path="data-creation.html"><a href="data-creation.html#add-additional-data"><i class="fa fa-check"></i><b>6.5.4</b> Add additional data</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-creation.html"><a href="data-creation.html#creating-analysis-dataframes"><i class="fa fa-check"></i><b>6.6</b> Creating analysis dataframes</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-creation.html"><a href="data-creation.html#final-data-check"><i class="fa fa-check"></i><b>6.6.1</b> Final data check</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>7</b> Analysis covariates</a>
<ul>
<li class="chapter" data-level="7.1" data-path="covariates.html"><a href="covariates.html#species-traits"><i class="fa fa-check"></i><b>7.1</b> Species traits</a></li>
<li class="chapter" data-level="7.2" data-path="covariates.html"><a href="covariates.html#camera-station-covariates"><i class="fa fa-check"></i><b>7.2</b> Camera station covariates</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="covariates.html"><a href="covariates.html#locally-collected-covariates"><i class="fa fa-check"></i><b>7.2.1</b> Locally collected covariates</a></li>
<li class="chapter" data-level="7.2.2" data-path="covariates.html"><a href="covariates.html#remotely-collected-covariates"><i class="fa fa-check"></i><b>7.2.2</b> Remotely collected covariates</a></li>
<li class="chapter" data-level="7.2.3" data-path="covariates.html"><a href="covariates.html#extracting-data-from-local-rasters"><i class="fa fa-check"></i><b>7.2.3</b> Extracting data from local rasters</a></li>
<li class="chapter" data-level="7.2.4" data-path="covariates.html"><a href="covariates.html#elevatr-package"><i class="fa fa-check"></i><b>7.2.4</b> elevatr package</a></li>
<li class="chapter" data-level="7.2.5" data-path="covariates.html"><a href="covariates.html#open-street-maps"><i class="fa fa-check"></i><b>7.2.5</b> Open Street Maps</a></li>
<li class="chapter" data-level="7.2.6" data-path="covariates.html"><a href="covariates.html#vegetation-productivity"><i class="fa fa-check"></i><b>7.2.6</b> Vegetation productivity</a></li>
<li class="chapter" data-level="7.2.7" data-path="covariates.html"><a href="covariates.html#digging-deeper"><i class="fa fa-check"></i><b>7.2.7</b> Digging deeper</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="covariates.html"><a href="covariates.html#convert-and-save-your-covariates"><i class="fa fa-check"></i><b>7.3</b> Convert and save your covariates</a></li>
<li class="chapter" data-level="7.4" data-path="covariates.html"><a href="covariates.html#correlations-between-predictors"><i class="fa fa-check"></i><b>7.4</b> Correlations between predictors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exploration.html"><a href="exploration.html"><i class="fa fa-check"></i><b>8</b> Analysis data exploration</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exploration.html"><a href="exploration.html#final-locations-plot"><i class="fa fa-check"></i><b>8.1</b> Final locations plot</a></li>
<li class="chapter" data-level="8.2" data-path="exploration.html"><a href="exploration.html#independent-detections-summary"><i class="fa fa-check"></i><b>8.2</b> Independent detections summary</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="exploration.html"><a href="exploration.html#total-number-of-captures"><i class="fa fa-check"></i><b>8.2.1</b> Total number of captures</a></li>
<li class="chapter" data-level="8.2.2" data-path="exploration.html"><a href="exploration.html#raw-occupancy"><i class="fa fa-check"></i><b>8.2.2</b> Raw occupancy</a></li>
<li class="chapter" data-level="8.2.3" data-path="exploration.html"><a href="exploration.html#comparison-plot"><i class="fa fa-check"></i><b>8.2.3</b> Comparison plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exploration.html"><a href="exploration.html#temporal-patterns-in-capture-rates"><i class="fa fa-check"></i><b>8.3</b> Temporal patterns in capture rates</a></li>
<li class="chapter" data-level="8.4" data-path="exploration.html"><a href="exploration.html#species-specific-capture-rates"><i class="fa fa-check"></i><b>8.4</b> Species-specific capture rates</a></li>
<li class="chapter" data-level="8.5" data-path="exploration.html"><a href="exploration.html#spatial-patterns-in-capture-rates"><i class="fa fa-check"></i><b>8.5</b> Spatial patterns in capture rates</a></li>
<li class="chapter" data-level="8.6" data-path="exploration.html"><a href="exploration.html#species-co-occurences"><i class="fa fa-check"></i><b>8.6</b> Species co-occurences</a></li>
<li class="chapter" data-level="8.7" data-path="exploration.html"><a href="exploration.html#covariate-plots"><i class="fa fa-check"></i><b>8.7</b> Covariate plots</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="exploration.html"><a href="exploration.html#continuous-predictors"><i class="fa fa-check"></i><b>8.7.1</b> Continuous predictors</a></li>
<li class="chapter" data-level="8.7.2" data-path="exploration.html"><a href="exploration.html#catagorical-predictors"><i class="fa fa-check"></i><b>8.7.2</b> Catagorical predictors</a></li>
<li class="chapter" data-level="8.7.3" data-path="exploration.html"><a href="exploration.html#do-your-own-exploration"><i class="fa fa-check"></i><b>8.7.3</b> Do your own exploration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="composition.html"><a href="composition.html"><i class="fa fa-check"></i><b>9</b> Community composition</a>
<ul>
<li class="chapter" data-level="9.1" data-path="composition.html"><a href="composition.html#observed-richness"><i class="fa fa-check"></i><b>9.1</b> Observed richness</a></li>
<li class="chapter" data-level="9.2" data-path="composition.html"><a href="composition.html#estimated-richness"><i class="fa fa-check"></i><b>9.2</b> Estimated richness</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="composition.html"><a href="composition.html#inext-package"><i class="fa fa-check"></i><b>9.2.1</b> iNext package</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="composition.html"><a href="composition.html#sampling-unit-based-accumulation-curves"><i class="fa fa-check"></i><b>9.3</b> Sampling-unit-based accumulation curves</a></li>
<li class="chapter" data-level="9.4" data-path="composition.html"><a href="composition.html#basic-results-plot"><i class="fa fa-check"></i><b>9.4</b> Basic results plot</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="composition.html"><a href="composition.html#sampling-duration-example"><i class="fa fa-check"></i><b>9.4.1</b> Sampling duration example</a></li>
<li class="chapter" data-level="9.4.2" data-path="composition.html"><a href="composition.html#on-your-own"><i class="fa fa-check"></i><b>9.4.2</b> On your own</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="composition.html"><a href="composition.html#other-diversity-metrics"><i class="fa fa-check"></i><b>9.5</b> Other diversity metrics</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="composition.html"><a href="composition.html#simpson-and-shannon"><i class="fa fa-check"></i><b>9.5.1</b> Simpson and Shannon</a></li>
<li class="chapter" data-level="9.5.2" data-path="composition.html"><a href="composition.html#more-examples-in-the-literature"><i class="fa fa-check"></i><b>9.5.2</b> More examples in the literature</a></li>
<li class="chapter" data-level="9.5.3" data-path="composition.html"><a href="composition.html#multispecies-occupancy-model"><i class="fa fa-check"></i><b>9.5.3</b> Multispecies occupancy model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="composition.html"><a href="composition.html#community-structure"><i class="fa fa-check"></i><b>9.6</b> Community structure</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="composition.html"><a href="composition.html#extracting-data-for-plotting"><i class="fa fa-check"></i><b>9.6.1</b> Extracting data for plotting</a></li>
<li class="chapter" data-level="9.6.2" data-path="composition.html"><a href="composition.html#on-your-own-1"><i class="fa fa-check"></i><b>9.6.2</b> On your own</a></li>
<li class="chapter" data-level="9.6.3" data-path="composition.html"><a href="composition.html#examples-in-the-literature"><i class="fa fa-check"></i><b>9.6.3</b> Examples in the literature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="habitat-use.html"><a href="habitat-use.html"><i class="fa fa-check"></i><b>10</b> Habitat use</a>
<ul>
<li class="chapter" data-level="10.1" data-path="habitat-use.html"><a href="habitat-use.html#calculating-capture-rate"><i class="fa fa-check"></i><b>10.1</b> Calculating capture rate</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="habitat-use.html"><a href="habitat-use.html#examples-from-the-literature"><i class="fa fa-check"></i><b>10.1.1</b> Examples from the literature</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="habitat-use.html"><a href="habitat-use.html#single-species-models"><i class="fa fa-check"></i><b>10.2</b> Single-species models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="habitat-use.html"><a href="habitat-use.html#simple-linear-model"><i class="fa fa-check"></i><b>10.2.1</b> Simple linear model</a></li>
<li class="chapter" data-level="10.2.2" data-path="habitat-use.html"><a href="habitat-use.html#catagorical-predictor"><i class="fa fa-check"></i><b>10.2.2</b> Catagorical predictor</a></li>
<li class="chapter" data-level="10.2.3" data-path="habitat-use.html"><a href="habitat-use.html#continuous-predictor"><i class="fa fa-check"></i><b>10.2.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="10.2.4" data-path="habitat-use.html"><a href="habitat-use.html#model-comparisons"><i class="fa fa-check"></i><b>10.2.4</b> Model comparisons</a></li>
<li class="chapter" data-level="10.2.5" data-path="habitat-use.html"><a href="habitat-use.html#problems-with-these-models"><i class="fa fa-check"></i><b>10.2.5</b> Problems with these models</a></li>
<li class="chapter" data-level="10.2.6" data-path="habitat-use.html"><a href="habitat-use.html#mixed-effects-models"><i class="fa fa-check"></i><b>10.2.6</b> Mixed-effects models</a></li>
<li class="chapter" data-level="10.2.7" data-path="habitat-use.html"><a href="habitat-use.html#on-your-own-2"><i class="fa fa-check"></i><b>10.2.7</b> On your own</a></li>
<li class="chapter" data-level="10.2.8" data-path="habitat-use.html"><a href="habitat-use.html#advanced-mixed-model-predictions"><i class="fa fa-check"></i><b>10.2.8</b> Advanced mixed-model predictions</a></li>
<li class="chapter" data-level="10.2.9" data-path="habitat-use.html"><a href="habitat-use.html#examples-in-the-literature-1"><i class="fa fa-check"></i><b>10.2.9</b> Examples in the literature</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="habitat-use.html"><a href="habitat-use.html#multispecies-models"><i class="fa fa-check"></i><b>10.3</b> Multispecies models</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="habitat-use.html"><a href="habitat-use.html#potential-dangers"><i class="fa fa-check"></i><b>10.3.1</b> Potential dangers</a></li>
<li class="chapter" data-level="10.3.2" data-path="habitat-use.html"><a href="habitat-use.html#further-reading"><i class="fa fa-check"></i><b>10.3.2</b> Further reading</a></li>
<li class="chapter" data-level="10.3.3" data-path="habitat-use.html"><a href="habitat-use.html#examples-in-the-literature-2"><i class="fa fa-check"></i><b>10.3.3</b> Examples in the literature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="occupancy.html"><a href="occupancy.html"><i class="fa fa-check"></i><b>11</b> Occupancy</a>
<ul>
<li class="chapter" data-level="11.1" data-path="occupancy.html"><a href="occupancy.html#single-species-occupancy-model"><i class="fa fa-check"></i><b>11.1</b> Single species occupancy model</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="occupancy.html"><a href="occupancy.html#unmarked-package"><i class="fa fa-check"></i><b>11.1.1</b> Unmarked package</a></li>
<li class="chapter" data-level="11.1.2" data-path="occupancy.html"><a href="occupancy.html#plotting-predictions"><i class="fa fa-check"></i><b>11.1.2</b> Plotting predictions</a></li>
<li class="chapter" data-level="11.1.3" data-path="occupancy.html"><a href="occupancy.html#on-your-own-3"><i class="fa fa-check"></i><b>11.1.3</b> On your own</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="occupancy.html"><a href="occupancy.html#spatial-occupancy-model-spoccupancy"><i class="fa fa-check"></i><b>11.2</b> Spatial occupancy model: spOccupancy</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="occupancy.html"><a href="occupancy.html#multi-species-model"><i class="fa fa-check"></i><b>11.2.1</b> Multi species model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="activity.html"><a href="activity.html"><i class="fa fa-check"></i><b>12</b> Activity</a>
<ul>
<li class="chapter" data-level="12.1" data-path="activity.html"><a href="activity.html#independent-detections-or-raw-data"><i class="fa fa-check"></i><b>12.1</b> Independent detections or raw data?</a></li>
<li class="chapter" data-level="12.2" data-path="activity.html"><a href="activity.html#data-formatting"><i class="fa fa-check"></i><b>12.2</b> Data formatting</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="activity.html"><a href="activity.html#accounting-for-sunrise-and-sunset"><i class="fa fa-check"></i><b>12.2.1</b> Accounting for sunrise and sunset</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="activity.html"><a href="activity.html#species-comparisons"><i class="fa fa-check"></i><b>12.3</b> Species comparisons</a></li>
<li class="chapter" data-level="12.4" data-path="activity.html"><a href="activity.html#treatment-comparisons"><i class="fa fa-check"></i><b>12.4</b> Treatment comparisons</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="activity.html"><a href="activity.html#seasonal-comparison"><i class="fa fa-check"></i><b>12.4.1</b> Seasonal comparison</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="activity.html"><a href="activity.html#on-your-own-4"><i class="fa fa-check"></i><b>12.5</b> On your own</a></li>
<li class="chapter" data-level="12.6" data-path="activity.html"><a href="activity.html#selected-further-reading"><i class="fa fa-check"></i><b>12.6</b> Selected further reading</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="density.html"><a href="density.html"><i class="fa fa-check"></i><b>13</b> Density</a>
<ul>
<li class="chapter" data-level="13.1" data-path="density.html"><a href="density.html#individually-identifiable-individuals"><i class="fa fa-check"></i><b>13.1</b> Individually identifiable individuals</a></li>
<li class="chapter" data-level="13.2" data-path="density.html"><a href="density.html#unmarked-animals"><i class="fa fa-check"></i><b>13.2</b> Unmarked animals</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="density.html"><a href="density.html#random-encounter-model"><i class="fa fa-check"></i><b>13.2.1</b> Random encounter model</a></li>
<li class="chapter" data-level="13.2.2" data-path="density.html"><a href="density.html#moose"><i class="fa fa-check"></i><b>13.2.2</b> Moose</a></li>
<li class="chapter" data-level="13.2.3" data-path="density.html"><a href="density.html#wolf"><i class="fa fa-check"></i><b>13.2.3</b> Wolf</a></li>
<li class="chapter" data-level="13.2.4" data-path="density.html"><a href="density.html#time-to-event-space-to-event-density-estimates"><i class="fa fa-check"></i><b>13.2.4</b> Time to event / Space to event density estimates</a></li>
<li class="chapter" data-level="13.2.5" data-path="density.html"><a href="density.html#n-mixture-model-in-unmarked"><i class="fa fa-check"></i><b>13.2.5</b> N-mixture model in unmarked</a></li>
<li class="chapter" data-level="13.2.6" data-path="density.html"><a href="density.html#abmi-method"><i class="fa fa-check"></i><b>13.2.6</b> ABMI Method</a></li>
<li class="chapter" data-level="13.2.7" data-path="density.html"><a href="density.html#unmarked-spatial-capture-recapture-uscr"><i class="fa fa-check"></i><b>13.2.7</b> Unmarked spatial capture recapture (uSCR)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="density.html"><a href="density.html#future-directions"><i class="fa fa-check"></i><b>13.3</b> Future directions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="behavior.html"><a href="behavior.html"><i class="fa fa-check"></i><b>14</b> Behavior</a>
<ul>
<li class="chapter" data-level="14.1" data-path="behavior.html"><a href="behavior.html#behavioural-designations"><i class="fa fa-check"></i><b>14.1</b> Behavioural designations</a></li>
<li class="chapter" data-level="14.2" data-path="behavior.html"><a href="behavior.html#event-duration"><i class="fa fa-check"></i><b>14.2</b> Event duration</a></li>
<li class="chapter" data-level="14.3" data-path="behavior.html"><a href="behavior.html#animal-speed-and-day-range"><i class="fa fa-check"></i><b>14.3</b> Animal speed and day range</a></li>
<li class="chapter" data-level="14.4" data-path="behavior.html"><a href="behavior.html#experimental-manipulations"><i class="fa fa-check"></i><b>14.4</b> Experimental manipulations</a></li>
<li class="chapter" data-level="14.5" data-path="behavior.html"><a href="behavior.html#interactions"><i class="fa fa-check"></i><b>14.5</b> Interactions</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="behavior.html"><a href="behavior.html#activity-overlap"><i class="fa fa-check"></i><b>14.5.1</b> Activity overlap</a></li>
<li class="chapter" data-level="14.5.2" data-path="behavior.html"><a href="behavior.html#one-species-as-a-predictor-of-another"><i class="fa fa-check"></i><b>14.5.2</b> One species as a predictor of another</a></li>
<li class="chapter" data-level="14.5.3" data-path="behavior.html"><a href="behavior.html#residual-co-occurence-models"><i class="fa fa-check"></i><b>14.5.3</b> Residual co-occurence models</a></li>
<li class="chapter" data-level="14.5.4" data-path="behavior.html"><a href="behavior.html#attractance-avoidance-ratios-aar"><i class="fa fa-check"></i><b>14.5.4</b> Attractance-Avoidance Ratios (AAR)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="behavior.html"><a href="behavior.html#worked-examples"><i class="fa fa-check"></i><b>14.6</b> Worked examples</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="on-your-own-5.html"><a href="on-your-own-5.html"><i class="fa fa-check"></i><b>15</b> On your own</a>
<ul>
<li class="chapter" data-level="15.1" data-path="on-your-own-5.html"><a href="on-your-own-5.html#working-with-a-new-dataset"><i class="fa fa-check"></i><b>15.1</b> Working with a new dataset</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="on-your-own-5.html"><a href="on-your-own-5.html#read-in-the-data-and-packages"><i class="fa fa-check"></i><b>15.1.1</b> Read in the data and packages</a></li>
<li class="chapter" data-level="15.1.2" data-path="on-your-own-5.html"><a href="on-your-own-5.html#format-the-dates"><i class="fa fa-check"></i><b>15.1.2</b> Format the dates</a></li>
<li class="chapter" data-level="15.1.3" data-path="on-your-own-5.html"><a href="on-your-own-5.html#plot-and-correct-spatial-co-ordinates"><i class="fa fa-check"></i><b>15.1.3</b> Plot and correct spatial co-ordinates</a></li>
<li class="chapter" data-level="15.1.4" data-path="on-your-own-5.html"><a href="on-your-own-5.html#check-camera-spacing"><i class="fa fa-check"></i><b>15.1.4</b> Check camera spacing</a></li>
<li class="chapter" data-level="15.1.5" data-path="on-your-own-5.html"><a href="on-your-own-5.html#check-all-deployments-have-image-data"><i class="fa fa-check"></i><b>15.1.5</b> Check all deployments have image data</a></li>
<li class="chapter" data-level="15.1.6" data-path="on-your-own-5.html"><a href="on-your-own-5.html#b.-check-all-images-have-deployment-data"><i class="fa fa-check"></i><b>15.1.6</b> 5b. Check all images have deployment data</a></li>
<li class="chapter" data-level="15.1.7" data-path="on-your-own-5.html"><a href="on-your-own-5.html#c.-check-deployments-occur-where-you-expect"><i class="fa fa-check"></i><b>15.1.7</b> 5c. Check deployments occur where you expect</a></li>
<li class="chapter" data-level="15.1.8" data-path="on-your-own-5.html"><a href="on-your-own-5.html#check-images-occur-within-deployments"><i class="fa fa-check"></i><b>15.1.8</b> Check images occur within deployments</a></li>
<li class="chapter" data-level="15.1.9" data-path="on-your-own-5.html"><a href="on-your-own-5.html#check-species-taxonomy"><i class="fa fa-check"></i><b>15.1.9</b> Check species taxonomy</a></li>
<li class="chapter" data-level="15.1.10" data-path="on-your-own-5.html"><a href="on-your-own-5.html#check-species-activity"><i class="fa fa-check"></i><b>15.1.10</b> Check species activity</a></li>
<li class="chapter" data-level="15.1.11" data-path="on-your-own-5.html"><a href="on-your-own-5.html#filter-to-target-species-1"><i class="fa fa-check"></i><b>15.1.11</b> Filter to target species</a></li>
<li class="chapter" data-level="15.1.12" data-path="on-your-own-5.html"><a href="on-your-own-5.html#make-effort-look_up"><i class="fa fa-check"></i><b>15.1.12</b> Make effort look_up</a></li>
<li class="chapter" data-level="15.1.13" data-path="on-your-own-5.html"><a href="on-your-own-5.html#create-independent-data"><i class="fa fa-check"></i><b>15.1.13</b> Create independent data</a></li>
<li class="chapter" data-level="15.1.14" data-path="on-your-own-5.html"><a href="on-your-own-5.html#create-analysis-dataframes"><i class="fa fa-check"></i><b>15.1.14</b> Create analysis dataframes</a></li>
<li class="chapter" data-level="15.1.15" data-path="on-your-own-5.html"><a href="on-your-own-5.html#check-analysis-dataframe-counts"><i class="fa fa-check"></i><b>15.1.15</b> Check analysis dataframe counts</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="on-your-own-5.html"><a href="on-your-own-5.html#add-your-covariates"><i class="fa fa-check"></i><b>15.2</b> Add your covariates</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="on-your-own-5.html"><a href="on-your-own-5.html#species-traits-1"><i class="fa fa-check"></i><b>15.2.1</b> Species Traits</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="on-your-own-5.html"><a href="on-your-own-5.html#spatial-data"><i class="fa fa-check"></i><b>15.3</b> Spatial data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="on-your-own-5.html"><a href="on-your-own-5.html#convert-to-simple-features"><i class="fa fa-check"></i><b>15.3.1</b> Convert to simple features</a></li>
<li class="chapter" data-level="15.3.2" data-path="on-your-own-5.html"><a href="on-your-own-5.html#get-elevation-data"><i class="fa fa-check"></i><b>15.3.2</b> Get elevation data</a></li>
<li class="chapter" data-level="15.3.3" data-path="on-your-own-5.html"><a href="on-your-own-5.html#open-street-map-data"><i class="fa fa-check"></i><b>15.3.3</b> Open street map data</a></li>
<li class="chapter" data-level="15.3.4" data-path="on-your-own-5.html"><a href="on-your-own-5.html#ndvi"><i class="fa fa-check"></i><b>15.3.4</b> NDVI</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="on-your-own-5.html"><a href="on-your-own-5.html#data-exploration"><i class="fa fa-check"></i><b>15.4</b> Data exploration</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="on-your-own-5.html"><a href="on-your-own-5.html#final-map"><i class="fa fa-check"></i><b>15.4.1</b> Final map</a></li>
<li class="chapter" data-level="15.4.2" data-path="on-your-own-5.html"><a href="on-your-own-5.html#detection-summary"><i class="fa fa-check"></i><b>15.4.2</b> Detection summary</a></li>
<li class="chapter" data-level="15.4.3" data-path="on-your-own-5.html"><a href="on-your-own-5.html#temporal-patterns"><i class="fa fa-check"></i><b>15.4.3</b> Temporal patterns</a></li>
<li class="chapter" data-level="15.4.4" data-path="on-your-own-5.html"><a href="on-your-own-5.html#spatial-patterns"><i class="fa fa-check"></i><b>15.4.4</b> Spatial patterns</a></li>
<li class="chapter" data-level="15.4.5" data-path="on-your-own-5.html"><a href="on-your-own-5.html#species-co-occurance"><i class="fa fa-check"></i><b>15.4.5</b> Species co-occurance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Camera Trap Data Management and Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="on-your-own-5" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Chapter 15</span> On your own<a href="on-your-own-5.html#on-your-own-5" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Congratulations! You made it to the end of the planned content in one peice.</p>
<p>You now have the opportunity to apply some of the skills you have learnt to a completely new database. Cut and paste your code from previous chapters to check the data, write the analysis date frames and explore the dataset.</p>
<p>I will help you read in the data - and correct a mistake I made. Then you are on your own!</p>
<div id="working-with-a-new-dataset" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Working with a new dataset<a href="on-your-own-5.html#working-with-a-new-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="read-in-the-data-and-packages" class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Read in the data and packages<a href="on-your-own-5.html#read-in-the-data-and-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb319"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb319-1"><a href="on-your-own-5.html#cb319-1" tabindex="-1"></a><span class="co"># Load your data </span></span>
<span id="cb319-2"><a href="on-your-own-5.html#cb319-2" tabindex="-1"></a>pro <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/raw_data/your_data/projects.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb319-3"><a href="on-your-own-5.html#cb319-3" tabindex="-1"></a><span class="co"># I missed of the project ID from all the dataframes so we need to update those</span></span>
<span id="cb319-4"><a href="on-your-own-5.html#cb319-4" tabindex="-1"></a>pro<span class="sc">$</span>project_id <span class="ot">&lt;-</span> pro<span class="sc">$</span>project_name</span>
<span id="cb319-5"><a href="on-your-own-5.html#cb319-5" tabindex="-1"></a></span>
<span id="cb319-6"><a href="on-your-own-5.html#cb319-6" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/raw_data/your_data/images.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb319-7"><a href="on-your-own-5.html#cb319-7" tabindex="-1"></a>img<span class="sc">$</span>project_id <span class="ot">&lt;-</span> pro<span class="sc">$</span>project_name</span>
<span id="cb319-8"><a href="on-your-own-5.html#cb319-8" tabindex="-1"></a></span>
<span id="cb319-9"><a href="on-your-own-5.html#cb319-9" tabindex="-1"></a>dep <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/raw_data/your_data/deployments.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb319-10"><a href="on-your-own-5.html#cb319-10" tabindex="-1"></a>dep<span class="sc">$</span>project_id <span class="ot">&lt;-</span> pro<span class="sc">$</span>project_name</span>
<span id="cb319-11"><a href="on-your-own-5.html#cb319-11" tabindex="-1"></a></span>
<span id="cb319-12"><a href="on-your-own-5.html#cb319-12" tabindex="-1"></a>cam <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/raw_data/your_data/cameras.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb319-13"><a href="on-your-own-5.html#cb319-13" tabindex="-1"></a>cam<span class="sc">$</span>project_id <span class="ot">&lt;-</span> pro<span class="sc">$</span>project_name</span>
<span id="cb319-14"><a href="on-your-own-5.html#cb319-14" tabindex="-1"></a></span>
<span id="cb319-15"><a href="on-your-own-5.html#cb319-15" tabindex="-1"></a></span>
<span id="cb319-16"><a href="on-your-own-5.html#cb319-16" tabindex="-1"></a><span class="co"># A list of the required packages</span></span>
<span id="cb319-17"><a href="on-your-own-5.html#cb319-17" tabindex="-1"></a>list.of.packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;activity&quot;</span>, <span class="st">&quot;corrplot&quot;</span>, <span class="st">&quot;cowplot&quot;</span>, <span class="st">&quot;dplyr&quot;</span>,  <span class="st">&quot;elevatr&quot;</span>, <span class="st">&quot;gfcanalysis&quot;</span>,   <span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;gridExtra&quot;</span>, <span class="st">&quot;iNEXT&quot;</span>, <span class="st">&quot;kableExtra&quot;</span>, <span class="st">&quot;Hmsc&quot;</span>, <span class="st">&quot;leaflet&quot;</span>, <span class="st">&quot;lme4&quot;</span>, <span class="st">&quot;lubridate&quot;</span>, <span class="st">&quot;magrittr&quot;</span>, <span class="st">&quot;MCMCvis&quot;</span>, <span class="st">&quot;MODISTools&quot;</span>, <span class="st">&quot;osmdata&quot;</span>, <span class="st">&quot;pals&quot;</span>, <span class="st">&quot;plotly&quot;</span>, <span class="st">&quot;remotes&quot;</span>, <span class="st">&quot;rmarkdown&quot;</span>, <span class="st">&quot;sf&quot;</span>, <span class="st">&quot;spOccupancy&quot;</span>, <span class="st">&quot;stars&quot;</span>, <span class="st">&quot;stringr&quot;</span>, <span class="st">&quot;terra&quot;</span>, <span class="st">&quot;tibble&quot;</span>, <span class="st">&quot;tidyr&quot;</span>,  <span class="st">&quot;unmarked&quot;</span>, <span class="st">&quot;viridis&quot;</span>, <span class="st">&quot;jtools&quot;</span>, <span class="st">&quot;vegan&quot;</span>, <span class="st">&quot;MuMIn&quot;</span>)</span>
<span id="cb319-18"><a href="on-your-own-5.html#cb319-18" tabindex="-1"></a></span>
<span id="cb319-19"><a href="on-your-own-5.html#cb319-19" tabindex="-1"></a><span class="co"># A check to see which ones you have and which are missing</span></span>
<span id="cb319-20"><a href="on-your-own-5.html#cb319-20" tabindex="-1"></a>new.packages <span class="ot">&lt;-</span> list.of.packages[<span class="sc">!</span>(list.of.packages <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[,<span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb319-21"><a href="on-your-own-5.html#cb319-21" tabindex="-1"></a></span>
<span id="cb319-22"><a href="on-your-own-5.html#cb319-22" tabindex="-1"></a><span class="co"># Code which tells R to install the missing packages</span></span>
<span id="cb319-23"><a href="on-your-own-5.html#cb319-23" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(new.packages)) <span class="fu">install.packages</span>(new.packages)</span>
<span id="cb319-24"><a href="on-your-own-5.html#cb319-24" tabindex="-1"></a><span class="fu">lapply</span>(list.of.packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb319-25"><a href="on-your-own-5.html#cb319-25" tabindex="-1"></a></span>
<span id="cb319-26"><a href="on-your-own-5.html#cb319-26" tabindex="-1"></a><span class="co"># Add the &#39;placename&#39; column to the image data. </span></span>
<span id="cb319-27"><a href="on-your-own-5.html#cb319-27" tabindex="-1"></a><span class="co"># The following code matches every deployment ID in images, with deployment_id&#39;s and placenames in the deployment data. </span></span>
<span id="cb319-28"><a href="on-your-own-5.html#cb319-28" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">left_join</span>(img, dep[,<span class="fu">c</span>(<span class="st">&quot;deployment_id&quot;</span>, <span class="st">&quot;placename&quot;</span>)])</span></code></pre></div>
</div>
<div id="format-the-dates" class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Format the dates<a href="on-your-own-5.html#format-the-dates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb320"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb320-1"><a href="on-your-own-5.html#cb320-1" tabindex="-1"></a><span class="co"># Deployment dates</span></span>
<span id="cb320-2"><a href="on-your-own-5.html#cb320-2" tabindex="-1"></a><span class="co"># start dates</span></span>
<span id="cb320-3"><a href="on-your-own-5.html#cb320-3" tabindex="-1"></a>dep<span class="sc">$</span>start_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(dep<span class="sc">$</span>start_date)</span>
<span id="cb320-4"><a href="on-your-own-5.html#cb320-4" tabindex="-1"></a></span>
<span id="cb320-5"><a href="on-your-own-5.html#cb320-5" tabindex="-1"></a><span class="co"># end dates</span></span>
<span id="cb320-6"><a href="on-your-own-5.html#cb320-6" tabindex="-1"></a>dep<span class="sc">$</span>end_date   <span class="ot">&lt;-</span> <span class="fu">ymd</span>(dep<span class="sc">$</span>end_date)</span>
<span id="cb320-7"><a href="on-your-own-5.html#cb320-7" tabindex="-1"></a></span>
<span id="cb320-8"><a href="on-your-own-5.html#cb320-8" tabindex="-1"></a><span class="co"># camera days</span></span>
<span id="cb320-9"><a href="on-your-own-5.html#cb320-9" tabindex="-1"></a>dep<span class="sc">$</span>days <span class="ot">&lt;-</span> <span class="fu">interval</span>(dep<span class="sc">$</span>start_date, dep<span class="sc">$</span>end_date)<span class="sc">/</span><span class="fu">ddays</span>(<span class="dv">1</span>)</span>
<span id="cb320-10"><a href="on-your-own-5.html#cb320-10" tabindex="-1"></a></span>
<span id="cb320-11"><a href="on-your-own-5.html#cb320-11" tabindex="-1"></a><span class="co"># Image dates</span></span>
<span id="cb320-12"><a href="on-your-own-5.html#cb320-12" tabindex="-1"></a><span class="co"># Image timestamp</span></span>
<span id="cb320-13"><a href="on-your-own-5.html#cb320-13" tabindex="-1"></a>img<span class="sc">$</span>timestamp <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(img<span class="sc">$</span>timestamp)</span></code></pre></div>
</div>
<div id="plot-and-correct-spatial-co-ordinates" class="section level3 hasAnchor" number="15.1.3">
<h3><span class="header-section-number">15.1.3</span> Plot and correct spatial co-ordinates<a href="on-your-own-5.html#plot-and-correct-spatial-co-ordinates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb321"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb321-1"><a href="on-your-own-5.html#cb321-1" tabindex="-1"></a><span class="co"># Pick the category you want to color</span></span>
<span id="cb321-2"><a href="on-your-own-5.html#cb321-2" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="st">&quot;feature_type&quot;</span></span>
<span id="cb321-3"><a href="on-your-own-5.html#cb321-3" tabindex="-1"></a></span>
<span id="cb321-4"><a href="on-your-own-5.html#cb321-4" tabindex="-1"></a><span class="co"># We first convert this category to a factor with discrete levels</span></span>
<span id="cb321-5"><a href="on-your-own-5.html#cb321-5" tabindex="-1"></a>dep[,category] <span class="ot">&lt;-</span> <span class="fu">factor</span>(dep[,category])</span>
<span id="cb321-6"><a href="on-your-own-5.html#cb321-6" tabindex="-1"></a><span class="co"># then use the turbo() function to assign each level a color</span></span>
<span id="cb321-7"><a href="on-your-own-5.html#cb321-7" tabindex="-1"></a>col.cat <span class="ot">&lt;-</span> <span class="fu">turbo</span>(<span class="fu">length</span>(<span class="fu">levels</span>(dep[,category])))</span>
<span id="cb321-8"><a href="on-your-own-5.html#cb321-8" tabindex="-1"></a><span class="co"># then we apply it to the dataframe</span></span>
<span id="cb321-9"><a href="on-your-own-5.html#cb321-9" tabindex="-1"></a>dep<span class="sc">$</span>colours <span class="ot">&lt;-</span> col.cat[dep[,category]]</span>
<span id="cb321-10"><a href="on-your-own-5.html#cb321-10" tabindex="-1"></a></span>
<span id="cb321-11"><a href="on-your-own-5.html#cb321-11" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb321-12"><a href="on-your-own-5.html#cb321-12" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldImagery, <span class="at">group=</span><span class="st">&quot;Satellite&quot;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb321-13"><a href="on-your-own-5.html#cb321-13" tabindex="-1"></a>  <span class="fu">addTiles</span>(<span class="at">group=</span><span class="st">&quot;Base&quot;</span>) <span class="sc">%&gt;%</span>     <span class="co"># Include a basemap option too</span></span>
<span id="cb321-14"><a href="on-your-own-5.html#cb321-14" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng=</span>dep<span class="sc">$</span>longitude, <span class="at">lat=</span>dep<span class="sc">$</span>latitude,</span>
<span id="cb321-15"><a href="on-your-own-5.html#cb321-15" tabindex="-1"></a>                   <span class="co"># Co lour the markers depending on the &#39;feature type&#39;</span></span>
<span id="cb321-16"><a href="on-your-own-5.html#cb321-16" tabindex="-1"></a>                   <span class="at">color=</span>dep<span class="sc">$</span>colours,</span>
<span id="cb321-17"><a href="on-your-own-5.html#cb321-17" tabindex="-1"></a>                   <span class="co"># Add a popup of the placename and feature_type together </span></span>
<span id="cb321-18"><a href="on-your-own-5.html#cb321-18" tabindex="-1"></a>                   <span class="at">popup=</span><span class="fu">paste</span>(dep<span class="sc">$</span>placename, dep[,category])) <span class="sc">%&gt;%</span></span>
<span id="cb321-19"><a href="on-your-own-5.html#cb321-19" tabindex="-1"></a>  </span>
<span id="cb321-20"><a href="on-your-own-5.html#cb321-20" tabindex="-1"></a>  <span class="co"># Add a legend explaining what is going on</span></span>
<span id="cb321-21"><a href="on-your-own-5.html#cb321-21" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">colors =</span> col.cat,  <span class="at">labels =</span> <span class="fu">levels</span>(dep[,category]),</span>
<span id="cb321-22"><a href="on-your-own-5.html#cb321-22" tabindex="-1"></a>                   <span class="at">title =</span> category,</span>
<span id="cb321-23"><a href="on-your-own-5.html#cb321-23" tabindex="-1"></a>                   <span class="at">labFormat =</span> <span class="fu">labelFormat</span>(<span class="at">prefix =</span> <span class="st">&quot;$&quot;</span>),</span>
<span id="cb321-24"><a href="on-your-own-5.html#cb321-24" tabindex="-1"></a>                   <span class="at">opacity =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb321-25"><a href="on-your-own-5.html#cb321-25" tabindex="-1"></a>  </span>
<span id="cb321-26"><a href="on-your-own-5.html#cb321-26" tabindex="-1"></a>  <span class="co"># add a layer control box to toggle between the layers</span></span>
<span id="cb321-27"><a href="on-your-own-5.html#cb321-27" tabindex="-1"></a>  <span class="fu">addLayersControl</span>(</span>
<span id="cb321-28"><a href="on-your-own-5.html#cb321-28" tabindex="-1"></a>                    <span class="at">baseGroups =</span> <span class="fu">c</span>(<span class="st">&quot;Satellite&quot;</span>, <span class="st">&quot;Base&quot;</span>))</span>
<span id="cb321-29"><a href="on-your-own-5.html#cb321-29" tabindex="-1"></a></span>
<span id="cb321-30"><a href="on-your-own-5.html#cb321-30" tabindex="-1"></a>m</span></code></pre></div>
<p><strong>QUESTION</strong> What is the survey design? Hint: zoom in.</p>
</div>
<div id="check-camera-spacing" class="section level3 hasAnchor" number="15.1.4">
<h3><span class="header-section-number">15.1.4</span> Check camera spacing<a href="on-your-own-5.html#check-camera-spacing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb322"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb322-1"><a href="on-your-own-5.html#cb322-1" tabindex="-1"></a><span class="co"># Distance between traps</span></span>
<span id="cb322-2"><a href="on-your-own-5.html#cb322-2" tabindex="-1"></a>camera_locs <span class="ot">&lt;-</span> dep <span class="sc">%&gt;%</span> </span>
<span id="cb322-3"><a href="on-your-own-5.html#cb322-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(placename, latitude, longitude) <span class="sc">%&gt;%</span> </span>
<span id="cb322-4"><a href="on-your-own-5.html#cb322-4" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="co"># remove duplicated rows (rows where the placename and coordinates match)</span></span>
<span id="cb322-5"><a href="on-your-own-5.html#cb322-5" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>), <span class="at">crs =</span> <span class="st">&quot;+proj=longlat&quot;</span>) <span class="co"># Convert to `sf` format</span></span>
<span id="cb322-6"><a href="on-your-own-5.html#cb322-6" tabindex="-1"></a></span>
<span id="cb322-7"><a href="on-your-own-5.html#cb322-7" tabindex="-1"></a><span class="co"># distance matrix for all cameras</span></span>
<span id="cb322-8"><a href="on-your-own-5.html#cb322-8" tabindex="-1"></a>camera_dist <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(camera_locs) <span class="sc">%&gt;%</span> </span>
<span id="cb322-9"><a href="on-your-own-5.html#cb322-9" tabindex="-1"></a>                  <span class="fu">as.dist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb322-10"><a href="on-your-own-5.html#cb322-10" tabindex="-1"></a>                  usedist<span class="sc">::</span><span class="fu">dist_setNames</span>(<span class="fu">as.character</span>(camera_locs<span class="sc">$</span>placename)) <span class="sc">%&gt;%</span> </span>
<span id="cb322-11"><a href="on-your-own-5.html#cb322-11" tabindex="-1"></a>                  <span class="fu">as.matrix</span>()</span>
<span id="cb322-12"><a href="on-your-own-5.html#cb322-12" tabindex="-1"></a></span>
<span id="cb322-13"><a href="on-your-own-5.html#cb322-13" tabindex="-1"></a>camera_dist_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb322-14"><a href="on-your-own-5.html#cb322-14" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb322-15"><a href="on-your-own-5.html#cb322-15" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(camera_dist))</span>
<span id="cb322-16"><a href="on-your-own-5.html#cb322-16" tabindex="-1"></a>{</span>
<span id="cb322-17"><a href="on-your-own-5.html#cb322-17" tabindex="-1"></a>  camera_dist_list[[i]]<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">placename=</span><span class="fu">row.names</span>(camera_dist)[i], <span class="at">dist=</span> <span class="fu">min</span>(camera_dist[i,][camera_dist[i,]<span class="sc">!=</span><span class="dv">0</span>]))</span>
<span id="cb322-18"><a href="on-your-own-5.html#cb322-18" tabindex="-1"></a>}</span>
<span id="cb322-19"><a href="on-your-own-5.html#cb322-19" tabindex="-1"></a>camera_dist_list <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(camera_dist_list)</span>
<span id="cb322-20"><a href="on-your-own-5.html#cb322-20" tabindex="-1"></a><span class="fu">summary</span>(camera_dist_list<span class="sc">$</span>dist)</span></code></pre></div>
<p>Do you have anything to be worried about here?</p>
</div>
<div id="check-all-deployments-have-image-data" class="section level3 hasAnchor" number="15.1.5">
<h3><span class="header-section-number">15.1.5</span> Check all deployments have image data<a href="on-your-own-5.html#check-all-deployments-have-image-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb323"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb323-1"><a href="on-your-own-5.html#cb323-1" tabindex="-1"></a><span class="co"># Do all deployments have images</span></span>
<span id="cb323-2"><a href="on-your-own-5.html#cb323-2" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">unique</span>(dep<span class="sc">$</span>placename)  <span class="sc">%in%</span> <span class="fu">unique</span>(img<span class="sc">$</span>placename))</span></code></pre></div>
</div>
<div id="b.-check-all-images-have-deployment-data" class="section level3 hasAnchor" number="15.1.6">
<h3><span class="header-section-number">15.1.6</span> 5b. Check all images have deployment data<a href="on-your-own-5.html#b.-check-all-images-have-deployment-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb324"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb324-1"><a href="on-your-own-5.html#cb324-1" tabindex="-1"></a><span class="co"># Do all deployments have images</span></span>
<span id="cb324-2"><a href="on-your-own-5.html#cb324-2" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">unique</span>(img<span class="sc">$</span>placename) <span class="sc">%in%</span> <span class="fu">unique</span>(dep<span class="sc">$</span>placename))</span></code></pre></div>
</div>
<div id="c.-check-deployments-occur-where-you-expect" class="section level3 hasAnchor" number="15.1.7">
<h3><span class="header-section-number">15.1.7</span> 5c. Check deployments occur where you expect<a href="on-your-own-5.html#c.-check-deployments-occur-where-you-expect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb325"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb325-1"><a href="on-your-own-5.html#cb325-1" tabindex="-1"></a><span class="co"># Call the plot</span></span>
<span id="cb325-2"><a href="on-your-own-5.html#cb325-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>()</span>
<span id="cb325-3"><a href="on-your-own-5.html#cb325-3" tabindex="-1"></a></span>
<span id="cb325-4"><a href="on-your-own-5.html#cb325-4" tabindex="-1"></a><span class="co"># We want a separate row for each &#39;placename&#39; - so lets turn it into a factor</span></span>
<span id="cb325-5"><a href="on-your-own-5.html#cb325-5" tabindex="-1"></a>dep<span class="sc">$</span>placename <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dep<span class="sc">$</span>placename)</span>
<span id="cb325-6"><a href="on-your-own-5.html#cb325-6" tabindex="-1"></a></span>
<span id="cb325-7"><a href="on-your-own-5.html#cb325-7" tabindex="-1"></a><span class="co"># loop through each place name</span></span>
<span id="cb325-8"><a href="on-your-own-5.html#cb325-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(<span class="fu">levels</span>(dep<span class="sc">$</span>placename)))</span>
<span id="cb325-9"><a href="on-your-own-5.html#cb325-9" tabindex="-1"></a>  {</span>
<span id="cb325-10"><a href="on-your-own-5.html#cb325-10" tabindex="-1"></a>      <span class="co">#Subset the data to just that placename</span></span>
<span id="cb325-11"><a href="on-your-own-5.html#cb325-11" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> dep[dep<span class="sc">$</span>placename<span class="sc">==</span><span class="fu">levels</span>(dep<span class="sc">$</span>placename)[i],]</span>
<span id="cb325-12"><a href="on-your-own-5.html#cb325-12" tabindex="-1"></a>      <span class="co"># Order by date</span></span>
<span id="cb325-13"><a href="on-your-own-5.html#cb325-13" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> tmp[<span class="fu">order</span>(tmp<span class="sc">$</span>start_date),]</span>
<span id="cb325-14"><a href="on-your-own-5.html#cb325-14" tabindex="-1"></a>      <span class="co"># Loop through each deployment at that placename</span></span>
<span id="cb325-15"><a href="on-your-own-5.html#cb325-15" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tmp))</span>
<span id="cb325-16"><a href="on-your-own-5.html#cb325-16" tabindex="-1"></a>      {</span>
<span id="cb325-17"><a href="on-your-own-5.html#cb325-17" tabindex="-1"></a>        <span class="co"># Add a line to &#39;p&#39;</span></span>
<span id="cb325-18"><a href="on-your-own-5.html#cb325-18" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">add_trace</span>(p, </span>
<span id="cb325-19"><a href="on-your-own-5.html#cb325-19" tabindex="-1"></a>                       <span class="co">#Use the start and end date as x coordinates</span></span>
<span id="cb325-20"><a href="on-your-own-5.html#cb325-20" tabindex="-1"></a>                       <span class="at">x =</span> <span class="fu">c</span>(tmp<span class="sc">$</span>start_date[j], tmp<span class="sc">$</span>end_date[j]), </span>
<span id="cb325-21"><a href="on-your-own-5.html#cb325-21" tabindex="-1"></a>                       <span class="co">#Use the counter for the y coordinates</span></span>
<span id="cb325-22"><a href="on-your-own-5.html#cb325-22" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">c</span>(i,i), </span>
<span id="cb325-23"><a href="on-your-own-5.html#cb325-23" tabindex="-1"></a>                       <span class="co"># State the type of chart</span></span>
<span id="cb325-24"><a href="on-your-own-5.html#cb325-24" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb325-25"><a href="on-your-own-5.html#cb325-25" tabindex="-1"></a>                       <span class="co"># make a line that also has points</span></span>
<span id="cb325-26"><a href="on-your-own-5.html#cb325-26" tabindex="-1"></a>                       <span class="at">mode =</span> <span class="st">&quot;lines+markers&quot;</span>, </span>
<span id="cb325-27"><a href="on-your-own-5.html#cb325-27" tabindex="-1"></a>                       <span class="co"># Add the deployment ID as hover text</span></span>
<span id="cb325-28"><a href="on-your-own-5.html#cb325-28" tabindex="-1"></a>                       <span class="at">hovertext=</span>tmp<span class="sc">$</span>deployment_id[j], </span>
<span id="cb325-29"><a href="on-your-own-5.html#cb325-29" tabindex="-1"></a>                       <span class="co"># Color it all black</span></span>
<span id="cb325-30"><a href="on-your-own-5.html#cb325-30" tabindex="-1"></a>                       <span class="at">color=</span><span class="fu">I</span>(<span class="st">&quot;black&quot;</span>), </span>
<span id="cb325-31"><a href="on-your-own-5.html#cb325-31" tabindex="-1"></a>                       <span class="co"># Suppress the legend</span></span>
<span id="cb325-32"><a href="on-your-own-5.html#cb325-32" tabindex="-1"></a>                       <span class="at">showlegend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb325-33"><a href="on-your-own-5.html#cb325-33" tabindex="-1"></a>      }</span>
<span id="cb325-34"><a href="on-your-own-5.html#cb325-34" tabindex="-1"></a>      </span>
<span id="cb325-35"><a href="on-your-own-5.html#cb325-35" tabindex="-1"></a>  }</span>
<span id="cb325-36"><a href="on-your-own-5.html#cb325-36" tabindex="-1"></a><span class="co"># Add a categorical y axis</span></span>
<span id="cb325-37"><a href="on-your-own-5.html#cb325-37" tabindex="-1"></a> p <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span>   <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb325-38"><a href="on-your-own-5.html#cb325-38" tabindex="-1"></a></span>
<span id="cb325-39"><a href="on-your-own-5.html#cb325-39" tabindex="-1"></a>      <span class="at">ticktext =</span> <span class="fu">as.list</span>(<span class="fu">levels</span>(dep<span class="sc">$</span>placename)), </span>
<span id="cb325-40"><a href="on-your-own-5.html#cb325-40" tabindex="-1"></a></span>
<span id="cb325-41"><a href="on-your-own-5.html#cb325-41" tabindex="-1"></a>      <span class="at">tickvals =</span> <span class="fu">as.list</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">levels</span>(dep<span class="sc">$</span>placename))),</span>
<span id="cb325-42"><a href="on-your-own-5.html#cb325-42" tabindex="-1"></a></span>
<span id="cb325-43"><a href="on-your-own-5.html#cb325-43" tabindex="-1"></a>      <span class="at">tickmode =</span> <span class="st">&quot;array&quot;</span>))</span>
<span id="cb325-44"><a href="on-your-own-5.html#cb325-44" tabindex="-1"></a></span>
<span id="cb325-45"><a href="on-your-own-5.html#cb325-45" tabindex="-1"></a></span>
<span id="cb325-46"><a href="on-your-own-5.html#cb325-46" tabindex="-1"></a>p</span></code></pre></div>
<p><strong>QUESTION</strong> What do you think about the camera deployments?</p>
</div>
<div id="check-images-occur-within-deployments" class="section level3 hasAnchor" number="15.1.8">
<h3><span class="header-section-number">15.1.8</span> Check images occur within deployments<a href="on-your-own-5.html#check-images-occur-within-deployments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb326"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb326-1"><a href="on-your-own-5.html#cb326-1" tabindex="-1"></a><span class="co">#Camera activity plot</span></span>
<span id="cb326-2"><a href="on-your-own-5.html#cb326-2" tabindex="-1"></a><span class="co"># Make a separate plot for each 30 stations </span></span>
<span id="cb326-3"><a href="on-your-own-5.html#cb326-3" tabindex="-1"></a><span class="co"># Order by placename to make the graphs easier to follow</span></span>
<span id="cb326-4"><a href="on-your-own-5.html#cb326-4" tabindex="-1"></a>dep <span class="ot">&lt;-</span> dep[<span class="fu">order</span>(dep<span class="sc">$</span>placename),]</span>
<span id="cb326-5"><a href="on-your-own-5.html#cb326-5" tabindex="-1"></a></span>
<span id="cb326-6"><a href="on-your-own-5.html#cb326-6" tabindex="-1"></a><span class="co"># To do this make a plot dataframe</span></span>
<span id="cb326-7"><a href="on-your-own-5.html#cb326-7" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;deployment_id&quot;</span><span class="ot">=</span><span class="fu">unique</span>(dep<span class="sc">$</span>deployment_id), <span class="st">&quot;plot_group&quot;</span><span class="ot">=</span><span class="fu">ceiling</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(dep<span class="sc">$</span>deployment_id))<span class="sc">/</span><span class="dv">30</span>))</span>
<span id="cb326-8"><a href="on-your-own-5.html#cb326-8" tabindex="-1"></a></span>
<span id="cb326-9"><a href="on-your-own-5.html#cb326-9" tabindex="-1"></a>dep_tmp <span class="ot">&lt;-</span> <span class="fu">left_join</span>(dep,tmp, <span class="at">by=</span><span class="st">&quot;deployment_id&quot;</span>)</span>
<span id="cb326-10"><a href="on-your-own-5.html#cb326-10" tabindex="-1"></a></span>
<span id="cb326-11"><a href="on-your-own-5.html#cb326-11" tabindex="-1"></a></span>
<span id="cb326-12"><a href="on-your-own-5.html#cb326-12" tabindex="-1"></a><span class="co"># Make a colour palette for blanks vs. real detections</span></span>
<span id="cb326-13"><a href="on-your-own-5.html#cb326-13" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb326-14"><a href="on-your-own-5.html#cb326-14" tabindex="-1"></a></span>
<span id="cb326-15"><a href="on-your-own-5.html#cb326-15" tabindex="-1"></a></span>
<span id="cb326-16"><a href="on-your-own-5.html#cb326-16" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(dep_tmp<span class="sc">$</span>plot_group))</span>
<span id="cb326-17"><a href="on-your-own-5.html#cb326-17" tabindex="-1"></a>{  </span>
<span id="cb326-18"><a href="on-your-own-5.html#cb326-18" tabindex="-1"></a>  <span class="co"># Call the plot</span></span>
<span id="cb326-19"><a href="on-your-own-5.html#cb326-19" tabindex="-1"></a>  </span>
<span id="cb326-20"><a href="on-your-own-5.html#cb326-20" tabindex="-1"></a>  <span class="co">#Subset the data to just that placename</span></span>
<span id="cb326-21"><a href="on-your-own-5.html#cb326-21" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> dep_tmp[dep_tmp<span class="sc">$</span>plot_group<span class="sc">==</span>i,]</span>
<span id="cb326-22"><a href="on-your-own-5.html#cb326-22" tabindex="-1"></a>  <span class="co"># Order by placename </span></span>
<span id="cb326-23"><a href="on-your-own-5.html#cb326-23" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> tmp[<span class="fu">order</span>(tmp<span class="sc">$</span>placename),]</span>
<span id="cb326-24"><a href="on-your-own-5.html#cb326-24" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() </span>
<span id="cb326-25"><a href="on-your-own-5.html#cb326-25" tabindex="-1"></a> <span class="co"># Loop through each deployment at that placename</span></span>
<span id="cb326-26"><a href="on-your-own-5.html#cb326-26" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tmp))</span>
<span id="cb326-27"><a href="on-your-own-5.html#cb326-27" tabindex="-1"></a>    {</span>
<span id="cb326-28"><a href="on-your-own-5.html#cb326-28" tabindex="-1"></a>        <span class="co">#Subset the image data</span></span>
<span id="cb326-29"><a href="on-your-own-5.html#cb326-29" tabindex="-1"></a>        tmp_img <span class="ot">&lt;-</span> img[img<span class="sc">$</span>deployment_id<span class="sc">==</span>tmp<span class="sc">$</span>deployment_id[j],]</span>
<span id="cb326-30"><a href="on-your-own-5.html#cb326-30" tabindex="-1"></a>        </span>
<span id="cb326-31"><a href="on-your-own-5.html#cb326-31" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">nrow</span>(tmp_img)<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb326-32"><a href="on-your-own-5.html#cb326-32" tabindex="-1"></a>        {</span>
<span id="cb326-33"><a href="on-your-own-5.html#cb326-33" tabindex="-1"></a>         </span>
<span id="cb326-34"><a href="on-your-own-5.html#cb326-34" tabindex="-1"></a>          p <span class="ot">&lt;-</span> <span class="fu">add_trace</span>(p, </span>
<span id="cb326-35"><a href="on-your-own-5.html#cb326-35" tabindex="-1"></a>                       <span class="co">#Use the start and end date as x coordinates</span></span>
<span id="cb326-36"><a href="on-your-own-5.html#cb326-36" tabindex="-1"></a>                       <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">ymd_hms</span>(tmp_img<span class="sc">$</span>timestamp)), </span>
<span id="cb326-37"><a href="on-your-own-5.html#cb326-37" tabindex="-1"></a>                       <span class="co">#Use the counter for the y coordinates</span></span>
<span id="cb326-38"><a href="on-your-own-5.html#cb326-38" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">rep</span>(j, <span class="fu">nrow</span>(tmp_img)), </span>
<span id="cb326-39"><a href="on-your-own-5.html#cb326-39" tabindex="-1"></a>                       <span class="co"># State the type of chart</span></span>
<span id="cb326-40"><a href="on-your-own-5.html#cb326-40" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb326-41"><a href="on-your-own-5.html#cb326-41" tabindex="-1"></a>                       <span class="co"># make a line that also has points</span></span>
<span id="cb326-42"><a href="on-your-own-5.html#cb326-42" tabindex="-1"></a>                       <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>, </span>
<span id="cb326-43"><a href="on-your-own-5.html#cb326-43" tabindex="-1"></a>                       <span class="co"># Add the deployment ID as hover text</span></span>
<span id="cb326-44"><a href="on-your-own-5.html#cb326-44" tabindex="-1"></a>                       <span class="at">hovertext=</span><span class="fu">paste</span>(tmp_img<span class="sc">$</span>genus,tmp_img<span class="sc">$</span>species), </span>
<span id="cb326-45"><a href="on-your-own-5.html#cb326-45" tabindex="-1"></a>                       <span class="co"># Color it all black</span></span>
<span id="cb326-46"><a href="on-your-own-5.html#cb326-46" tabindex="-1"></a>                       <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> cols[tmp_img<span class="sc">$</span>is_blank<span class="sc">+</span><span class="dv">1</span>]), </span>
<span id="cb326-47"><a href="on-your-own-5.html#cb326-47" tabindex="-1"></a>                       <span class="co"># Suppress the legend</span></span>
<span id="cb326-48"><a href="on-your-own-5.html#cb326-48" tabindex="-1"></a>                       <span class="at">showlegend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb326-49"><a href="on-your-own-5.html#cb326-49" tabindex="-1"></a>        }</span>
<span id="cb326-50"><a href="on-your-own-5.html#cb326-50" tabindex="-1"></a>        </span>
<span id="cb326-51"><a href="on-your-own-5.html#cb326-51" tabindex="-1"></a>       <span class="co"># Add a line to &#39;p&#39;</span></span>
<span id="cb326-52"><a href="on-your-own-5.html#cb326-52" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">add_trace</span>(p, </span>
<span id="cb326-53"><a href="on-your-own-5.html#cb326-53" tabindex="-1"></a>                       <span class="co">#Use the start and end date as x coordinates</span></span>
<span id="cb326-54"><a href="on-your-own-5.html#cb326-54" tabindex="-1"></a>                       <span class="at">x =</span> <span class="fu">c</span>(tmp<span class="sc">$</span>start_date[j], tmp<span class="sc">$</span>end_date[j]<span class="sc">+</span><span class="fu">days</span>(<span class="dv">1</span>)), </span>
<span id="cb326-55"><a href="on-your-own-5.html#cb326-55" tabindex="-1"></a>                       <span class="co">#Use the counter for the y coordinates</span></span>
<span id="cb326-56"><a href="on-your-own-5.html#cb326-56" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">c</span>(j,j), </span>
<span id="cb326-57"><a href="on-your-own-5.html#cb326-57" tabindex="-1"></a>                       <span class="co"># State the type of chart</span></span>
<span id="cb326-58"><a href="on-your-own-5.html#cb326-58" tabindex="-1"></a>                       <span class="at">type=</span><span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb326-59"><a href="on-your-own-5.html#cb326-59" tabindex="-1"></a>                       <span class="co"># make a line that also has points</span></span>
<span id="cb326-60"><a href="on-your-own-5.html#cb326-60" tabindex="-1"></a>                       <span class="at">mode =</span> <span class="st">&quot;lines&quot;</span>, </span>
<span id="cb326-61"><a href="on-your-own-5.html#cb326-61" tabindex="-1"></a>                       <span class="co"># Add the deployment ID as hover text</span></span>
<span id="cb326-62"><a href="on-your-own-5.html#cb326-62" tabindex="-1"></a>                       <span class="at">hovertext=</span>tmp<span class="sc">$</span>deployment_id[j], </span>
<span id="cb326-63"><a href="on-your-own-5.html#cb326-63" tabindex="-1"></a>                       <span class="co"># Color it all black</span></span>
<span id="cb326-64"><a href="on-your-own-5.html#cb326-64" tabindex="-1"></a>                       <span class="at">color=</span><span class="fu">I</span>(<span class="st">&quot;black&quot;</span>), </span>
<span id="cb326-65"><a href="on-your-own-5.html#cb326-65" tabindex="-1"></a>                       <span class="co"># Suppress the legend</span></span>
<span id="cb326-66"><a href="on-your-own-5.html#cb326-66" tabindex="-1"></a>                       <span class="at">showlegend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb326-67"><a href="on-your-own-5.html#cb326-67" tabindex="-1"></a>      }</span>
<span id="cb326-68"><a href="on-your-own-5.html#cb326-68" tabindex="-1"></a>  <span class="co"># Add custom y axis labels  </span></span>
<span id="cb326-69"><a href="on-your-own-5.html#cb326-69" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">%&gt;%</span>   <span class="fu">layout</span>(<span class="at">yaxis =</span> <span class="fu">list</span>(</span>
<span id="cb326-70"><a href="on-your-own-5.html#cb326-70" tabindex="-1"></a></span>
<span id="cb326-71"><a href="on-your-own-5.html#cb326-71" tabindex="-1"></a>      <span class="at">ticktext =</span> <span class="fu">as.list</span>(tmp<span class="sc">$</span>deployment_id), </span>
<span id="cb326-72"><a href="on-your-own-5.html#cb326-72" tabindex="-1"></a></span>
<span id="cb326-73"><a href="on-your-own-5.html#cb326-73" tabindex="-1"></a>      <span class="at">tickvals =</span> <span class="fu">as.list</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tmp)),</span>
<span id="cb326-74"><a href="on-your-own-5.html#cb326-74" tabindex="-1"></a></span>
<span id="cb326-75"><a href="on-your-own-5.html#cb326-75" tabindex="-1"></a>      <span class="at">tickmode =</span> <span class="st">&quot;array&quot;</span>))</span>
<span id="cb326-76"><a href="on-your-own-5.html#cb326-76" tabindex="-1"></a>  </span>
<span id="cb326-77"><a href="on-your-own-5.html#cb326-77" tabindex="-1"></a>  <span class="fu">print</span>(p)</span>
<span id="cb326-78"><a href="on-your-own-5.html#cb326-78" tabindex="-1"></a>      </span>
<span id="cb326-79"><a href="on-your-own-5.html#cb326-79" tabindex="-1"></a>  </span>
<span id="cb326-80"><a href="on-your-own-5.html#cb326-80" tabindex="-1"></a>} </span></code></pre></div>
<p>Note - there are three panels to check!</p>
<p><strong>QUESTION</strong> Do you need to make any edits? Note - there are three plot windows to check.</p>
<p>The camera failed for LAC061 - try to seem in and find out the last day it worked. Then update the deployment so the camera stops the day after the last correct date.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb327-1"><a href="on-your-own-5.html#cb327-1" tabindex="-1"></a><span class="co"># The camera failed for LAC061 </span></span>
<span id="cb327-2"><a href="on-your-own-5.html#cb327-2" tabindex="-1"></a>dep<span class="sc">$</span>end_date[dep<span class="sc">$</span>deployment_id<span class="sc">==</span><span class="st">&quot;LAC061_C186_010921&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">&quot;2021-09-09&quot;</span>)</span></code></pre></div>
<p>LAC064 also looks somewhat strange, that would be worth checking what happened. Lets leave it in for now.</p>
<p>We could maybe remove OFF067 and OFF072? Personal choice!</p>
</div>
<div id="check-species-taxonomy" class="section level3 hasAnchor" number="15.1.9">
<h3><span class="header-section-number">15.1.9</span> Check species taxonomy<a href="on-your-own-5.html#check-species-taxonomy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb328"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb328-1"><a href="on-your-own-5.html#cb328-1" tabindex="-1"></a><span class="co"># Create a species list</span></span>
<span id="cb328-2"><a href="on-your-own-5.html#cb328-2" tabindex="-1"></a><span class="co"># add an sp column to the img dataframe - remember the genus and species columns are not pasted together yet</span></span>
<span id="cb328-3"><a href="on-your-own-5.html#cb328-3" tabindex="-1"></a>img<span class="sc">$</span>sp <span class="ot">&lt;-</span> <span class="fu">paste</span>(img<span class="sc">$</span>genus, img<span class="sc">$</span>species, <span class="at">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb328-4"><a href="on-your-own-5.html#cb328-4" tabindex="-1"></a><span class="do">### Species lists</span></span>
<span id="cb328-5"><a href="on-your-own-5.html#cb328-5" tabindex="-1"></a></span>
<span id="cb328-6"><a href="on-your-own-5.html#cb328-6" tabindex="-1"></a><span class="co"># First define vector of the headings you want to see (we will use this trick a lot later on)</span></span>
<span id="cb328-7"><a href="on-your-own-5.html#cb328-7" tabindex="-1"></a>taxonomy_headings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;order&quot;</span>, <span class="st">&quot;family&quot;</span>, <span class="st">&quot;genus&quot;</span>, <span class="st">&quot;species&quot;</span>, <span class="st">&quot;common_name&quot;</span>)</span>
<span id="cb328-8"><a href="on-your-own-5.html#cb328-8" tabindex="-1"></a></span>
<span id="cb328-9"><a href="on-your-own-5.html#cb328-9" tabindex="-1"></a><span class="co"># Subset the image data to just those columns</span></span>
<span id="cb328-10"><a href="on-your-own-5.html#cb328-10" tabindex="-1"></a>tmp<span class="ot">&lt;-</span> img[,<span class="fu">colnames</span>(img)<span class="sc">%in%</span> taxonomy_headings]</span>
<span id="cb328-11"><a href="on-your-own-5.html#cb328-11" tabindex="-1"></a><span class="co"># Remove duplicates</span></span>
<span id="cb328-12"><a href="on-your-own-5.html#cb328-12" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> tmp[<span class="fu">duplicated</span>(tmp)<span class="sc">==</span>F,]</span>
<span id="cb328-13"><a href="on-your-own-5.html#cb328-13" tabindex="-1"></a></span>
<span id="cb328-14"><a href="on-your-own-5.html#cb328-14" tabindex="-1"></a><span class="co"># Create an ordered species list</span></span>
<span id="cb328-15"><a href="on-your-own-5.html#cb328-15" tabindex="-1"></a>sp_list  <span class="ot">&lt;-</span> tmp[<span class="fu">order</span>(tmp<span class="sc">$</span>class, tmp<span class="sc">$</span>order, tmp<span class="sc">$</span>family, tmp<span class="sc">$</span>genus, tmp<span class="sc">$</span>species),]</span>
<span id="cb328-16"><a href="on-your-own-5.html#cb328-16" tabindex="-1"></a>sp_list<span class="sc">$</span>sp <span class="ot">&lt;-</span> <span class="fu">paste</span>(sp_list<span class="sc">$</span>genus, sp_list<span class="sc">$</span>species, <span class="at">sep=</span><span class="st">&quot;.&quot;</span>)</span>
<span id="cb328-17"><a href="on-your-own-5.html#cb328-17" tabindex="-1"></a></span>
<span id="cb328-18"><a href="on-your-own-5.html#cb328-18" tabindex="-1"></a><span class="fu">write.csv</span>(sp_list, <span class="fu">paste0</span>(<span class="st">&quot;data/raw_data/&quot;</span>,pro<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_raw_species_list.csv&quot;</span>))</span></code></pre></div>
<p><strong>QUESTION</strong> Are there any classifications you will remove when we create our analysis dataframes?</p>
</div>
<div id="check-species-activity" class="section level3 hasAnchor" number="15.1.10">
<h3><span class="header-section-number">15.1.10</span> Check species activity<a href="on-your-own-5.html#check-species-activity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb329"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb329-1"><a href="on-your-own-5.html#cb329-1" tabindex="-1"></a><span class="co"># Diel activity check</span></span>
<span id="cb329-2"><a href="on-your-own-5.html#cb329-2" tabindex="-1"></a></span>
<span id="cb329-3"><a href="on-your-own-5.html#cb329-3" tabindex="-1"></a><span class="co"># First lets convert our timestamp to decimal hours</span></span>
<span id="cb329-4"><a href="on-your-own-5.html#cb329-4" tabindex="-1"></a>img<span class="sc">$</span>hours <span class="ot">&lt;-</span> <span class="fu">hour</span>(img<span class="sc">$</span>timestamp) <span class="sc">+</span> <span class="fu">minute</span>(img<span class="sc">$</span>timestamp)<span class="sc">/</span><span class="dv">60</span> <span class="sc">+</span> <span class="fu">second</span>(img<span class="sc">$</span>timestamp)<span class="sc">/</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span>)</span>
<span id="cb329-5"><a href="on-your-own-5.html#cb329-5" tabindex="-1"></a></span>
<span id="cb329-6"><a href="on-your-own-5.html#cb329-6" tabindex="-1"></a><span class="co"># Count all of the captures</span></span>
<span id="cb329-7"><a href="on-your-own-5.html#cb329-7" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> img <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(common_name) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">n</span>())</span>
<span id="cb329-8"><a href="on-your-own-5.html#cb329-8" tabindex="-1"></a></span>
<span id="cb329-9"><a href="on-your-own-5.html#cb329-9" tabindex="-1"></a>yform <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">categoryorder =</span> <span class="st">&quot;array&quot;</span>,</span>
<span id="cb329-10"><a href="on-your-own-5.html#cb329-10" tabindex="-1"></a>              <span class="at">categoryarray =</span> tmp<span class="sc">$</span>common_name)</span>
<span id="cb329-11"><a href="on-your-own-5.html#cb329-11" tabindex="-1"></a></span>
<span id="cb329-12"><a href="on-your-own-5.html#cb329-12" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> img<span class="sc">$</span>hours, <span class="at">y =</span> img<span class="sc">$</span>common_name,<span class="at">type=</span><span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb329-13"><a href="on-your-own-5.html#cb329-13" tabindex="-1"></a>               <span class="at">height=</span><span class="dv">1000</span>, <span class="at">text=</span>img<span class="sc">$</span>deployment_id, <span class="at">hoverinfo=</span><span class="st">&#39;text&#39;</span>,</span>
<span id="cb329-14"><a href="on-your-own-5.html#cb329-14" tabindex="-1"></a>               <span class="at">mode   =</span> <span class="st">&#39;markers&#39;</span>,</span>
<span id="cb329-15"><a href="on-your-own-5.html#cb329-15" tabindex="-1"></a>               <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb329-16"><a href="on-your-own-5.html#cb329-16" tabindex="-1"></a>                             <span class="at">color =</span> <span class="st">&#39;rgba(50, 100, 255, .2)&#39;</span>,</span>
<span id="cb329-17"><a href="on-your-own-5.html#cb329-17" tabindex="-1"></a>                             <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;rgba(0, 0, 0, 0)&#39;</span>,</span>
<span id="cb329-18"><a href="on-your-own-5.html#cb329-18" tabindex="-1"></a>                                         <span class="at">width =</span> <span class="dv">0</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb329-19"><a href="on-your-own-5.html#cb329-19" tabindex="-1"></a>              <span class="fu">layout</span>(<span class="at">yaxis =</span> yform)</span>
<span id="cb329-20"><a href="on-your-own-5.html#cb329-20" tabindex="-1"></a>fig</span>
<span id="cb329-21"><a href="on-your-own-5.html#cb329-21" tabindex="-1"></a></span>
<span id="cb329-22"><a href="on-your-own-5.html#cb329-22" tabindex="-1"></a><span class="co"># Remove the column</span></span>
<span id="cb329-23"><a href="on-your-own-5.html#cb329-23" tabindex="-1"></a>img<span class="sc">$</span>hours <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p><strong>QUESTION</strong> Are there any images you would like to check?</p>
<p>Note - Paca’s are nocturnal but they have some diurnal detections here. Check which station they come from. It might be that they are the same station as the one we excluded previously!</p>
</div>
<div id="filter-to-target-species-1" class="section level3 hasAnchor" number="15.1.11">
<h3><span class="header-section-number">15.1.11</span> Filter to target species<a href="on-your-own-5.html#filter-to-target-species-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb330"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb330-1"><a href="on-your-own-5.html#cb330-1" tabindex="-1"></a><span class="co"># Create your processed dataframe folder</span></span>
<span id="cb330-2"><a href="on-your-own-5.html#cb330-2" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;data/processed_data&quot;</span>)</span>
<span id="cb330-3"><a href="on-your-own-5.html#cb330-3" tabindex="-1"></a></span>
<span id="cb330-4"><a href="on-your-own-5.html#cb330-4" tabindex="-1"></a><span class="co"># Filter your species</span></span>
<span id="cb330-5"><a href="on-your-own-5.html#cb330-5" tabindex="-1"></a><span class="co"># Remove observations without animals detected, where we don&#39;t know the species, and non-mammals</span></span>
<span id="cb330-6"><a href="on-your-own-5.html#cb330-6" tabindex="-1"></a>img_sub <span class="ot">&lt;-</span> img <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is_blank<span class="sc">==</span><span class="dv">0</span>,                <span class="co"># Remove the blanks</span></span>
<span id="cb330-7"><a href="on-your-own-5.html#cb330-7" tabindex="-1"></a>                          <span class="fu">is.na</span>(img<span class="sc">$</span>species)<span class="sc">==</span><span class="cn">FALSE</span>, <span class="co"># Remove classifications which don&#39;t have species </span></span>
<span id="cb330-8"><a href="on-your-own-5.html#cb330-8" tabindex="-1"></a>                          class<span class="sc">==</span><span class="st">&quot;Mammalia&quot;</span>,          <span class="co"># Subset to mammals</span></span>
<span id="cb330-9"><a href="on-your-own-5.html#cb330-9" tabindex="-1"></a>                          species<span class="sc">!=</span><span class="st">&quot;sapiens&quot;</span>,</span>
<span id="cb330-10"><a href="on-your-own-5.html#cb330-10" tabindex="-1"></a>                          species<span class="sc">!=</span><span class="st">&quot;&quot;</span>)               <span class="co"># remove instances without species labels </span></span>
<span id="cb330-11"><a href="on-your-own-5.html#cb330-11" tabindex="-1"></a>                          </span>
<span id="cb330-12"><a href="on-your-own-5.html#cb330-12" tabindex="-1"></a><span class="fu">table</span>(img_sub<span class="sc">$</span>common_name)</span></code></pre></div>
<p><strong>QUESTION</strong> Are there any other classifications you would like to remove?</p>
</div>
<div id="make-effort-look_up" class="section level3 hasAnchor" number="15.1.12">
<h3><span class="header-section-number">15.1.12</span> Make effort look_up<a href="on-your-own-5.html#make-effort-look_up" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb331"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb331-1"><a href="on-your-own-5.html#cb331-1" tabindex="-1"></a><span class="do">##########################################</span></span>
<span id="cb331-2"><a href="on-your-own-5.html#cb331-2" tabindex="-1"></a><span class="co"># Create your daily lookup</span></span>
<span id="cb331-3"><a href="on-your-own-5.html#cb331-3" tabindex="-1"></a></span>
<span id="cb331-4"><a href="on-your-own-5.html#cb331-4" tabindex="-1"></a><span class="co"># Remove any deployments without end dates</span></span>
<span id="cb331-5"><a href="on-your-own-5.html#cb331-5" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> dep[<span class="fu">is.na</span>(dep<span class="sc">$</span>end_date)<span class="sc">==</span>F,]</span>
<span id="cb331-6"><a href="on-your-own-5.html#cb331-6" tabindex="-1"></a></span>
<span id="cb331-7"><a href="on-your-own-5.html#cb331-7" tabindex="-1"></a><span class="co"># Create an empty list to store our days</span></span>
<span id="cb331-8"><a href="on-your-own-5.html#cb331-8" tabindex="-1"></a>daily_lookup <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb331-9"><a href="on-your-own-5.html#cb331-9" tabindex="-1"></a></span>
<span id="cb331-10"><a href="on-your-own-5.html#cb331-10" tabindex="-1"></a><span class="co"># Loop through the deployment dataframe and create a row for every day the camera is active</span></span>
<span id="cb331-11"><a href="on-your-own-5.html#cb331-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tmp))</span>
<span id="cb331-12"><a href="on-your-own-5.html#cb331-12" tabindex="-1"></a>{</span>
<span id="cb331-13"><a href="on-your-own-5.html#cb331-13" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ymd</span>(tmp<span class="sc">$</span>start_date[i])<span class="sc">!=</span><span class="fu">ymd</span>(tmp<span class="sc">$</span>end_date[i]))</span>
<span id="cb331-14"><a href="on-your-own-5.html#cb331-14" tabindex="-1"></a>  {</span>
<span id="cb331-15"><a href="on-your-own-5.html#cb331-15" tabindex="-1"></a>    daily_lookup[[i]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;date&quot;</span><span class="ot">=</span><span class="fu">seq</span>(<span class="fu">ymd</span>(tmp<span class="sc">$</span>start_date[i]), <span class="fu">ymd</span>(tmp<span class="sc">$</span>end_date[i]), <span class="at">by=</span><span class="st">&quot;days&quot;</span>), <span class="st">&quot;placename&quot;</span><span class="ot">=</span>tmp<span class="sc">$</span>placename[i])</span>
<span id="cb331-16"><a href="on-your-own-5.html#cb331-16" tabindex="-1"></a>  }</span>
<span id="cb331-17"><a href="on-your-own-5.html#cb331-17" tabindex="-1"></a>}</span>
<span id="cb331-18"><a href="on-your-own-5.html#cb331-18" tabindex="-1"></a></span>
<span id="cb331-19"><a href="on-your-own-5.html#cb331-19" tabindex="-1"></a><span class="co"># Merge the lists into a dataframe</span></span>
<span id="cb331-20"><a href="on-your-own-5.html#cb331-20" tabindex="-1"></a>row_lookup <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(daily_lookup)</span>
<span id="cb331-21"><a href="on-your-own-5.html#cb331-21" tabindex="-1"></a></span>
<span id="cb331-22"><a href="on-your-own-5.html#cb331-22" tabindex="-1"></a><span class="co"># Remove duplicates - when start and end days are the same for successive deployments</span></span>
<span id="cb331-23"><a href="on-your-own-5.html#cb331-23" tabindex="-1"></a>row_lookup <span class="ot">&lt;-</span> row_lookup[<span class="fu">duplicated</span>(row_lookup)<span class="sc">==</span>F,]</span></code></pre></div>
</div>
<div id="create-independent-data" class="section level3 hasAnchor" number="15.1.13">
<h3><span class="header-section-number">15.1.13</span> Create independent data<a href="on-your-own-5.html#create-independent-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb332"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb332-1"><a href="on-your-own-5.html#cb332-1" tabindex="-1"></a><span class="do">###################################</span></span>
<span id="cb332-2"><a href="on-your-own-5.html#cb332-2" tabindex="-1"></a><span class="co"># Create your independent detections</span></span>
<span id="cb332-3"><a href="on-your-own-5.html#cb332-3" tabindex="-1"></a>independent <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb332-4"><a href="on-your-own-5.html#cb332-4" tabindex="-1"></a></span>
<span id="cb332-5"><a href="on-your-own-5.html#cb332-5" tabindex="-1"></a><span class="co"># Check for a `group_size` variable? </span></span>
<span id="cb332-6"><a href="on-your-own-5.html#cb332-6" tabindex="-1"></a><span class="fu">table</span>(img_sub<span class="sc">$</span>group_size)</span>
<span id="cb332-7"><a href="on-your-own-5.html#cb332-7" tabindex="-1"></a></span>
<span id="cb332-8"><a href="on-your-own-5.html#cb332-8" tabindex="-1"></a><span class="co"># Check for a &#39;number_of_objects&#39; variable</span></span>
<span id="cb332-9"><a href="on-your-own-5.html#cb332-9" tabindex="-1"></a><span class="fu">table</span>(img_sub<span class="sc">$</span>number_of_objects)</span></code></pre></div>
<p><strong>QUESTION</strong> WHich variable will you use for your <code>animal_count</code>?</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb333-1"><a href="on-your-own-5.html#cb333-1" tabindex="-1"></a>img_sub<span class="sc">$</span>animal_count <span class="ot">&lt;-</span> <span class="do">###INSERT YOUR SELECTION HERE###</span></span></code></pre></div>
<div class="sourceCode" id="cb334"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb334-1"><a href="on-your-own-5.html#cb334-1" tabindex="-1"></a><span class="co"># Create your independent data</span></span>
<span id="cb334-2"><a href="on-your-own-5.html#cb334-2" tabindex="-1"></a></span>
<span id="cb334-3"><a href="on-your-own-5.html#cb334-3" tabindex="-1"></a>img_tmp <span class="ot">&lt;-</span> img_sub <span class="sc">%&gt;%</span></span>
<span id="cb334-4"><a href="on-your-own-5.html#cb334-4" tabindex="-1"></a>              <span class="fu">arrange</span>(deployment_id) <span class="sc">%&gt;%</span>        <span class="co"># Order by deployment_id</span></span>
<span id="cb334-5"><a href="on-your-own-5.html#cb334-5" tabindex="-1"></a>              <span class="fu">group_by</span>(deployment_id, sp) <span class="sc">%&gt;%</span>   <span class="co"># Group species together</span></span>
<span id="cb334-6"><a href="on-your-own-5.html#cb334-6" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">duration =</span> <span class="fu">int_length</span>(timestamp <span class="sc">%--%</span> <span class="fu">lag</span>(timestamp))) <span class="co"># Calculate the gap bet</span></span>
<span id="cb334-7"><a href="on-your-own-5.html#cb334-7" tabindex="-1"></a></span>
<span id="cb334-8"><a href="on-your-own-5.html#cb334-8" tabindex="-1"></a></span>
<span id="cb334-9"><a href="on-your-own-5.html#cb334-9" tabindex="-1"></a></span>
<span id="cb334-10"><a href="on-your-own-5.html#cb334-10" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb334-11"><a href="on-your-own-5.html#cb334-11" tabindex="-1"></a><span class="co"># Give a random value to all cells</span></span>
<span id="cb334-12"><a href="on-your-own-5.html#cb334-12" tabindex="-1"></a>img_tmp<span class="sc">$</span>event_id <span class="ot">&lt;-</span> <span class="dv">9999</span></span>
<span id="cb334-13"><a href="on-your-own-5.html#cb334-13" tabindex="-1"></a></span>
<span id="cb334-14"><a href="on-your-own-5.html#cb334-14" tabindex="-1"></a><span class="co"># Create a counter</span></span>
<span id="cb334-15"><a href="on-your-own-5.html#cb334-15" tabindex="-1"></a>counter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb334-16"><a href="on-your-own-5.html#cb334-16" tabindex="-1"></a></span>
<span id="cb334-17"><a href="on-your-own-5.html#cb334-17" tabindex="-1"></a><span class="co"># Make a unique code that has one more zero than rows in your dataframe  </span></span>
<span id="cb334-18"><a href="on-your-own-5.html#cb334-18" tabindex="-1"></a>num_code <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">paste0</span>(<span class="fu">nrow</span>(img_sub),<span class="dv">0</span>))</span>
<span id="cb334-19"><a href="on-your-own-5.html#cb334-19" tabindex="-1"></a></span>
<span id="cb334-20"><a href="on-your-own-5.html#cb334-20" tabindex="-1"></a><span class="co"># Loop through img_tmp - if gap is greater than the threshold -&gt; give it a new event ID</span></span>
<span id="cb334-21"><a href="on-your-own-5.html#cb334-21" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(img_tmp)) {</span>
<span id="cb334-22"><a href="on-your-own-5.html#cb334-22" tabindex="-1"></a>  img_tmp<span class="sc">$</span>event_id[i<span class="dv">-1</span>]  <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;E&quot;</span>, <span class="fu">str_pad</span>(counter, <span class="fu">nchar</span>(num_code), <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>))</span>
<span id="cb334-23"><a href="on-your-own-5.html#cb334-23" tabindex="-1"></a>  </span>
<span id="cb334-24"><a href="on-your-own-5.html#cb334-24" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(img_tmp<span class="sc">$</span>duration[i]) <span class="sc">|</span> <span class="fu">abs</span>(img_tmp<span class="sc">$</span>duration[i]) <span class="sc">&gt;</span> (independent <span class="sc">*</span> <span class="dv">60</span>))</span>
<span id="cb334-25"><a href="on-your-own-5.html#cb334-25" tabindex="-1"></a>    {</span>
<span id="cb334-26"><a href="on-your-own-5.html#cb334-26" tabindex="-1"></a>      counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb334-27"><a href="on-your-own-5.html#cb334-27" tabindex="-1"></a>    }</span>
<span id="cb334-28"><a href="on-your-own-5.html#cb334-28" tabindex="-1"></a>}</span>
<span id="cb334-29"><a href="on-your-own-5.html#cb334-29" tabindex="-1"></a></span>
<span id="cb334-30"><a href="on-your-own-5.html#cb334-30" tabindex="-1"></a><span class="co"># Update the information for the last row - the loop above always updates the previous row... leaving the last row unchanged</span></span>
<span id="cb334-31"><a href="on-your-own-5.html#cb334-31" tabindex="-1"></a>   </span>
<span id="cb334-32"><a href="on-your-own-5.html#cb334-32" tabindex="-1"></a> <span class="co"># group ID  for the last row</span></span>
<span id="cb334-33"><a href="on-your-own-5.html#cb334-33" tabindex="-1"></a> <span class="cf">if</span>(img_tmp<span class="sc">$</span>duration[<span class="fu">nrow</span>(img_tmp)] <span class="sc">&lt;</span> (independent <span class="sc">*</span> <span class="dv">60</span>)<span class="sc">|</span></span>
<span id="cb334-34"><a href="on-your-own-5.html#cb334-34" tabindex="-1"></a>    <span class="fu">is.na</span>(img_tmp<span class="sc">$</span>duration[<span class="fu">nrow</span>(img_tmp)])){</span>
<span id="cb334-35"><a href="on-your-own-5.html#cb334-35" tabindex="-1"></a>   img_tmp<span class="sc">$</span>event_id[<span class="fu">nrow</span>(img_tmp)] <span class="ot">&lt;-</span> img_tmp<span class="sc">$</span>event_id[<span class="fu">nrow</span>(img_tmp)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb334-36"><a href="on-your-own-5.html#cb334-36" tabindex="-1"></a> } <span class="cf">else</span>{</span>
<span id="cb334-37"><a href="on-your-own-5.html#cb334-37" tabindex="-1"></a>   counter <span class="ot">&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb334-38"><a href="on-your-own-5.html#cb334-38" tabindex="-1"></a>   img_tmp<span class="sc">$</span>event_id[<span class="fu">nrow</span>(img_tmp)] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;E&quot;</span>, <span class="fu">str_pad</span>(counter, <span class="fu">nchar</span>(num_code), <span class="at">pad =</span> <span class="st">&quot;0&quot;</span>))</span>
<span id="cb334-39"><a href="on-your-own-5.html#cb334-39" tabindex="-1"></a> }</span>
<span id="cb334-40"><a href="on-your-own-5.html#cb334-40" tabindex="-1"></a></span>
<span id="cb334-41"><a href="on-your-own-5.html#cb334-41" tabindex="-1"></a><span class="co"># remove the duration column</span></span>
<span id="cb334-42"><a href="on-your-own-5.html#cb334-42" tabindex="-1"></a>img_tmp<span class="sc">$</span>duration <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb334-43"><a href="on-your-own-5.html#cb334-43" tabindex="-1"></a> </span>
<span id="cb334-44"><a href="on-your-own-5.html#cb334-44" tabindex="-1"></a></span>
<span id="cb334-45"><a href="on-your-own-5.html#cb334-45" tabindex="-1"></a></span>
<span id="cb334-46"><a href="on-your-own-5.html#cb334-46" tabindex="-1"></a> <span class="co"># find out the last and the first of the time in the group</span></span>
<span id="cb334-47"><a href="on-your-own-5.html#cb334-47" tabindex="-1"></a>  top <span class="ot">&lt;-</span> img_tmp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(event_id) <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="dv">1</span>,timestamp) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(event_id, timestamp)</span>
<span id="cb334-48"><a href="on-your-own-5.html#cb334-48" tabindex="-1"></a>  bot <span class="ot">&lt;-</span> img_tmp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(event_id) <span class="sc">%&gt;%</span> <span class="fu">top_n</span>(<span class="sc">-</span><span class="dv">1</span>,timestamp) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(event_id, timestamp)</span>
<span id="cb334-49"><a href="on-your-own-5.html#cb334-49" tabindex="-1"></a>  <span class="fu">names</span>(bot)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;timestamp_end&quot;</span>)</span>
<span id="cb334-50"><a href="on-your-own-5.html#cb334-50" tabindex="-1"></a>  </span>
<span id="cb334-51"><a href="on-your-own-5.html#cb334-51" tabindex="-1"></a>  img_num <span class="ot">&lt;-</span> img_tmp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(event_id) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">event_observations=</span><span class="fu">n</span>()) <span class="co"># number of images in the event</span></span>
<span id="cb334-52"><a href="on-your-own-5.html#cb334-52" tabindex="-1"></a>  event_grp <span class="ot">&lt;-</span> img_tmp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(event_id) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">event_groupsize=</span><span class="fu">max</span>(animal_count))</span>
<span id="cb334-53"><a href="on-your-own-5.html#cb334-53" tabindex="-1"></a></span>
<span id="cb334-54"><a href="on-your-own-5.html#cb334-54" tabindex="-1"></a>  <span class="co"># calculate the duration and add the other elements</span></span>
<span id="cb334-55"><a href="on-your-own-5.html#cb334-55" tabindex="-1"></a>  diff <span class="ot">&lt;-</span>  top <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(bot, <span class="at">by=</span><span class="st">&quot;event_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb334-56"><a href="on-your-own-5.html#cb334-56" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">event_duration=</span><span class="fu">abs</span>(<span class="fu">int_length</span>(timestamp <span class="sc">%--%</span> timestamp_end))) <span class="sc">%&gt;%</span></span>
<span id="cb334-57"><a href="on-your-own-5.html#cb334-57" tabindex="-1"></a>      <span class="fu">left_join</span>(event_grp, <span class="at">by=</span><span class="st">&quot;event_id&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb334-58"><a href="on-your-own-5.html#cb334-58" tabindex="-1"></a>      <span class="fu">left_join</span>(img_num, <span class="at">by=</span><span class="st">&quot;event_id&quot;</span>)</span>
<span id="cb334-59"><a href="on-your-own-5.html#cb334-59" tabindex="-1"></a></span>
<span id="cb334-60"><a href="on-your-own-5.html#cb334-60" tabindex="-1"></a>  <span class="co"># Remove columns you don&#39;t need</span></span>
<span id="cb334-61"><a href="on-your-own-5.html#cb334-61" tabindex="-1"></a>  diff<span class="sc">$</span>timestamp   <span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb334-62"><a href="on-your-own-5.html#cb334-62" tabindex="-1"></a>  diff<span class="sc">$</span>timestamp_end <span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb334-63"><a href="on-your-own-5.html#cb334-63" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> diff[<span class="fu">duplicated</span>(diff)<span class="sc">==</span>F,]</span>
<span id="cb334-64"><a href="on-your-own-5.html#cb334-64" tabindex="-1"></a>    <span class="co"># Merge the img_tmp with the event data</span></span>
<span id="cb334-65"><a href="on-your-own-5.html#cb334-65" tabindex="-1"></a>  img_tmp <span class="ot">&lt;-</span> </span>
<span id="cb334-66"><a href="on-your-own-5.html#cb334-66" tabindex="-1"></a>   <span class="fu">left_join</span>(img_tmp,diff,<span class="at">by=</span><span class="st">&quot;event_id&quot;</span>)</span>
<span id="cb334-67"><a href="on-your-own-5.html#cb334-67" tabindex="-1"></a>  </span>
<span id="cb334-68"><a href="on-your-own-5.html#cb334-68" tabindex="-1"></a>  </span>
<span id="cb334-69"><a href="on-your-own-5.html#cb334-69" tabindex="-1"></a>  <span class="co"># Remove duplicates</span></span>
<span id="cb334-70"><a href="on-your-own-5.html#cb334-70" tabindex="-1"></a>ind_dat <span class="ot">&lt;-</span> img_tmp[<span class="fu">duplicated</span>(img_tmp<span class="sc">$</span>event_id)<span class="sc">==</span>F,]</span>
<span id="cb334-71"><a href="on-your-own-5.html#cb334-71" tabindex="-1"></a></span>
<span id="cb334-72"><a href="on-your-own-5.html#cb334-72" tabindex="-1"></a><span class="co"># Make a  unique code for ever day and deployment where cameras were functioning</span></span>
<span id="cb334-73"><a href="on-your-own-5.html#cb334-73" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">paste</span>(row_lookup<span class="sc">$</span>date, row_lookup<span class="sc">$</span>placename)</span>
<span id="cb334-74"><a href="on-your-own-5.html#cb334-74" tabindex="-1"></a></span>
<span id="cb334-75"><a href="on-your-own-5.html#cb334-75" tabindex="-1"></a><span class="co">#Subset ind_dat to data that matches the unique codes</span></span>
<span id="cb334-76"><a href="on-your-own-5.html#cb334-76" tabindex="-1"></a>ind_dat <span class="ot">&lt;-</span> ind_dat[<span class="fu">paste</span>(<span class="fu">substr</span>(ind_dat<span class="sc">$</span>timestamp,<span class="dv">1</span>,<span class="dv">10</span>), ind_dat<span class="sc">$</span>placename) <span class="sc">%in%</span> tmp, ]</span>
<span id="cb334-77"><a href="on-your-own-5.html#cb334-77" tabindex="-1"></a></span>
<span id="cb334-78"><a href="on-your-own-5.html#cb334-78" tabindex="-1"></a><span class="co"># Convert your species names to factors</span></span>
<span id="cb334-79"><a href="on-your-own-5.html#cb334-79" tabindex="-1"></a>ind_dat<span class="sc">$</span>sp <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ind_dat<span class="sc">$</span>sp)</span>
<span id="cb334-80"><a href="on-your-own-5.html#cb334-80" tabindex="-1"></a></span>
<span id="cb334-81"><a href="on-your-own-5.html#cb334-81" tabindex="-1"></a><span class="co"># Export your data frames</span></span>
<span id="cb334-82"><a href="on-your-own-5.html#cb334-82" tabindex="-1"></a></span>
<span id="cb334-83"><a href="on-your-own-5.html#cb334-83" tabindex="-1"></a><span class="fu">write.csv</span>(ind_dat, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>,independent ,<span class="st">&quot;min_independent_detections.csv&quot;</span>), <span class="at">row.names =</span> F)</span>
<span id="cb334-84"><a href="on-your-own-5.html#cb334-84" tabindex="-1"></a></span>
<span id="cb334-85"><a href="on-your-own-5.html#cb334-85" tabindex="-1"></a><span class="co"># also write the cleaned all detections file (some activity analyses require it)</span></span>
<span id="cb334-86"><a href="on-your-own-5.html#cb334-86" tabindex="-1"></a><span class="fu">write.csv</span>(img_tmp, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_raw_detections.csv&quot;</span>), <span class="at">row.names =</span> F)</span>
<span id="cb334-87"><a href="on-your-own-5.html#cb334-87" tabindex="-1"></a></span>
<span id="cb334-88"><a href="on-your-own-5.html#cb334-88" tabindex="-1"></a><span class="fu">write.csv</span>(row_lookup, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_daily_lookup.csv&quot;</span>), <span class="at">row.names =</span> F)</span>
<span id="cb334-89"><a href="on-your-own-5.html#cb334-89" tabindex="-1"></a></span>
<span id="cb334-90"><a href="on-your-own-5.html#cb334-90" tabindex="-1"></a><span class="co">#Subset the columns</span></span>
<span id="cb334-91"><a href="on-your-own-5.html#cb334-91" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> dep[, <span class="fu">c</span>(<span class="st">&quot;project_id&quot;</span>, <span class="st">&quot;placename&quot;</span>, <span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>, <span class="st">&quot;feature_type&quot;</span>)]</span>
<span id="cb334-92"><a href="on-your-own-5.html#cb334-92" tabindex="-1"></a></span>
<span id="cb334-93"><a href="on-your-own-5.html#cb334-93" tabindex="-1"></a><span class="co"># Remove duplicated rows</span></span>
<span id="cb334-94"><a href="on-your-own-5.html#cb334-94" tabindex="-1"></a>tmp<span class="ot">&lt;-</span> tmp[<span class="fu">duplicated</span>(tmp)<span class="sc">==</span>F,]</span>
<span id="cb334-95"><a href="on-your-own-5.html#cb334-95" tabindex="-1"></a></span>
<span id="cb334-96"><a href="on-your-own-5.html#cb334-96" tabindex="-1"></a><span class="co"># write the file</span></span>
<span id="cb334-97"><a href="on-your-own-5.html#cb334-97" tabindex="-1"></a><span class="fu">write.csv</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_camera_locations.csv&quot;</span>), <span class="at">row.names =</span> F)</span>
<span id="cb334-98"><a href="on-your-own-5.html#cb334-98" tabindex="-1"></a></span>
<span id="cb334-99"><a href="on-your-own-5.html#cb334-99" tabindex="-1"></a></span>
<span id="cb334-100"><a href="on-your-own-5.html#cb334-100" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> sp_list[sp_list<span class="sc">$</span>sp <span class="sc">%in%</span> ind_dat<span class="sc">$</span>sp,]</span>
<span id="cb334-101"><a href="on-your-own-5.html#cb334-101" tabindex="-1"></a></span>
<span id="cb334-102"><a href="on-your-own-5.html#cb334-102" tabindex="-1"></a><span class="fu">write.csv</span>(tmp, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_species_list.csv&quot;</span>), <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="create-analysis-dataframes" class="section level3 hasAnchor" number="15.1.14">
<h3><span class="header-section-number">15.1.14</span> Create analysis dataframes<a href="on-your-own-5.html#create-analysis-dataframes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the next step, we won’t create the daily dataframe as it takes too long!</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb335-1"><a href="on-your-own-5.html#cb335-1" tabindex="-1"></a><span class="co"># Total counts</span></span>
<span id="cb335-2"><a href="on-your-own-5.html#cb335-2" tabindex="-1"></a>  <span class="co"># Station / Month / deport / Species      </span></span>
<span id="cb335-3"><a href="on-your-own-5.html#cb335-3" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> row_lookup</span>
<span id="cb335-4"><a href="on-your-own-5.html#cb335-4" tabindex="-1"></a>  </span>
<span id="cb335-5"><a href="on-your-own-5.html#cb335-5" tabindex="-1"></a>  <span class="co"># Calculate the number of days at each site  </span></span>
<span id="cb335-6"><a href="on-your-own-5.html#cb335-6" tabindex="-1"></a>  total_obs <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span> </span>
<span id="cb335-7"><a href="on-your-own-5.html#cb335-7" tabindex="-1"></a>      <span class="fu">group_by</span>(placename) <span class="sc">%&gt;%</span></span>
<span id="cb335-8"><a href="on-your-own-5.html#cb335-8" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">days =</span> <span class="fu">n</span>())</span>
<span id="cb335-9"><a href="on-your-own-5.html#cb335-9" tabindex="-1"></a>  </span>
<span id="cb335-10"><a href="on-your-own-5.html#cb335-10" tabindex="-1"></a>  <span class="co"># Convert to a data frame</span></span>
<span id="cb335-11"><a href="on-your-own-5.html#cb335-11" tabindex="-1"></a>  total_obs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(total_obs)</span>
<span id="cb335-12"><a href="on-your-own-5.html#cb335-12" tabindex="-1"></a>  </span>
<span id="cb335-13"><a href="on-your-own-5.html#cb335-13" tabindex="-1"></a>  <span class="co"># Add columns for each species  </span></span>
<span id="cb335-14"><a href="on-your-own-5.html#cb335-14" tabindex="-1"></a>  total_obs[, <span class="fu">levels</span>(ind_dat<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb335-15"><a href="on-your-own-5.html#cb335-15" tabindex="-1"></a>  <span class="co"># Duplicate for counts</span></span>
<span id="cb335-16"><a href="on-your-own-5.html#cb335-16" tabindex="-1"></a>  total_count <span class="ot">&lt;-</span> total_obs</span>
<span id="cb335-17"><a href="on-your-own-5.html#cb335-17" tabindex="-1"></a>  <span class="co"># Test counter</span></span>
<span id="cb335-18"><a href="on-your-own-5.html#cb335-18" tabindex="-1"></a>  i <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb335-19"><a href="on-your-own-5.html#cb335-19" tabindex="-1"></a>  <span class="co"># For each station, count the number of individuals/observations</span></span>
<span id="cb335-20"><a href="on-your-own-5.html#cb335-20" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(total_obs))</span>
<span id="cb335-21"><a href="on-your-own-5.html#cb335-21" tabindex="-1"></a>    {</span>
<span id="cb335-22"><a href="on-your-own-5.html#cb335-22" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> ind_dat[ind_dat<span class="sc">$</span>placename<span class="sc">==</span>total_obs<span class="sc">$</span>placename[i],]</span>
<span id="cb335-23"><a href="on-your-own-5.html#cb335-23" tabindex="-1"></a>      </span>
<span id="cb335-24"><a href="on-your-own-5.html#cb335-24" tabindex="-1"></a>      tmp_stats <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(sp, <span class="at">.drop=</span>F) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">obs=</span><span class="fu">n</span>(), <span class="at">count=</span><span class="fu">sum</span>(animal_count))</span>
<span id="cb335-25"><a href="on-your-own-5.html#cb335-25" tabindex="-1"></a>      </span>
<span id="cb335-26"><a href="on-your-own-5.html#cb335-26" tabindex="-1"></a>      total_obs[i,<span class="fu">as.character</span>(tmp_stats<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> tmp_stats<span class="sc">$</span>obs</span>
<span id="cb335-27"><a href="on-your-own-5.html#cb335-27" tabindex="-1"></a>      total_count[i,<span class="fu">as.character</span>(tmp_stats<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> tmp_stats<span class="sc">$</span>count</span>
<span id="cb335-28"><a href="on-your-own-5.html#cb335-28" tabindex="-1"></a>    }</span>
<span id="cb335-29"><a href="on-your-own-5.html#cb335-29" tabindex="-1"></a></span>
<span id="cb335-30"><a href="on-your-own-5.html#cb335-30" tabindex="-1"></a>  </span>
<span id="cb335-31"><a href="on-your-own-5.html#cb335-31" tabindex="-1"></a><span class="co"># Save them</span></span>
<span id="cb335-32"><a href="on-your-own-5.html#cb335-32" tabindex="-1"></a>    </span>
<span id="cb335-33"><a href="on-your-own-5.html#cb335-33" tabindex="-1"></a><span class="fu">write.csv</span>(total_obs, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>,independent ,<span class="st">&quot;min_independent_total_observations.csv&quot;</span>), <span class="at">row.names =</span> F) </span>
<span id="cb335-34"><a href="on-your-own-5.html#cb335-34" tabindex="-1"></a></span>
<span id="cb335-35"><a href="on-your-own-5.html#cb335-35" tabindex="-1"></a><span class="fu">write.csv</span>(total_count, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>,independent ,<span class="st">&quot;min_independent_total_counts.csv&quot;</span>), <span class="at">row.names =</span> F) </span>
<span id="cb335-36"><a href="on-your-own-5.html#cb335-36" tabindex="-1"></a></span>
<span id="cb335-37"><a href="on-your-own-5.html#cb335-37" tabindex="-1"></a></span>
<span id="cb335-38"><a href="on-your-own-5.html#cb335-38" tabindex="-1"></a><span class="co"># Monthly counts</span></span>
<span id="cb335-39"><a href="on-your-own-5.html#cb335-39" tabindex="-1"></a>  <span class="co"># Station / Month / days / Covariates / Species      </span></span>
<span id="cb335-40"><a href="on-your-own-5.html#cb335-40" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> row_lookup</span>
<span id="cb335-41"><a href="on-your-own-5.html#cb335-41" tabindex="-1"></a>  <span class="co"># Simplify the date to monthly</span></span>
<span id="cb335-42"><a href="on-your-own-5.html#cb335-42" tabindex="-1"></a>  tmp<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">substr</span>(tmp<span class="sc">$</span>date,<span class="dv">1</span>,<span class="dv">7</span>)</span>
<span id="cb335-43"><a href="on-your-own-5.html#cb335-43" tabindex="-1"></a>  </span>
<span id="cb335-44"><a href="on-your-own-5.html#cb335-44" tabindex="-1"></a>  <span class="co"># Calculate the number of days in each month  </span></span>
<span id="cb335-45"><a href="on-your-own-5.html#cb335-45" tabindex="-1"></a>  mon_obs <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span> </span>
<span id="cb335-46"><a href="on-your-own-5.html#cb335-46" tabindex="-1"></a>      <span class="fu">group_by</span>(placename,date ) <span class="sc">%&gt;%</span></span>
<span id="cb335-47"><a href="on-your-own-5.html#cb335-47" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">days =</span> <span class="fu">n</span>())</span>
<span id="cb335-48"><a href="on-your-own-5.html#cb335-48" tabindex="-1"></a>  <span class="co"># Convert to a data frame</span></span>
<span id="cb335-49"><a href="on-your-own-5.html#cb335-49" tabindex="-1"></a>  mon_obs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mon_obs)</span>
<span id="cb335-50"><a href="on-your-own-5.html#cb335-50" tabindex="-1"></a>    </span>
<span id="cb335-51"><a href="on-your-own-5.html#cb335-51" tabindex="-1"></a>  mon_obs[, <span class="fu">levels</span>(ind_dat<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb335-52"><a href="on-your-own-5.html#cb335-52" tabindex="-1"></a>  mon_count <span class="ot">&lt;-</span> mon_obs</span>
<span id="cb335-53"><a href="on-your-own-5.html#cb335-53" tabindex="-1"></a>  <span class="co"># For each month, count the number of individuals/observations</span></span>
<span id="cb335-54"><a href="on-your-own-5.html#cb335-54" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mon_obs))</span>
<span id="cb335-55"><a href="on-your-own-5.html#cb335-55" tabindex="-1"></a>    {</span>
<span id="cb335-56"><a href="on-your-own-5.html#cb335-56" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> ind_dat[ind_dat<span class="sc">$</span>placename<span class="sc">==</span>mon_obs<span class="sc">$</span>placename[i] <span class="sc">&amp;</span> <span class="fu">substr</span>(ind_dat<span class="sc">$</span>timestamp,<span class="dv">1</span>,<span class="dv">7</span>)<span class="sc">==</span> mon_obs<span class="sc">$</span>date[i],]</span>
<span id="cb335-57"><a href="on-your-own-5.html#cb335-57" tabindex="-1"></a>      </span>
<span id="cb335-58"><a href="on-your-own-5.html#cb335-58" tabindex="-1"></a>      tmp_stats <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(sp, <span class="at">.drop=</span>F) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">obs=</span><span class="fu">n</span>(), <span class="at">count=</span><span class="fu">sum</span>(animal_count))</span>
<span id="cb335-59"><a href="on-your-own-5.html#cb335-59" tabindex="-1"></a>      </span>
<span id="cb335-60"><a href="on-your-own-5.html#cb335-60" tabindex="-1"></a>      mon_obs[i,<span class="fu">as.character</span>(tmp_stats<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> tmp_stats<span class="sc">$</span>obs</span>
<span id="cb335-61"><a href="on-your-own-5.html#cb335-61" tabindex="-1"></a>      mon_count[i,<span class="fu">as.character</span>(tmp_stats<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> tmp_stats<span class="sc">$</span>count</span>
<span id="cb335-62"><a href="on-your-own-5.html#cb335-62" tabindex="-1"></a>      </span>
<span id="cb335-63"><a href="on-your-own-5.html#cb335-63" tabindex="-1"></a>    }</span>
<span id="cb335-64"><a href="on-your-own-5.html#cb335-64" tabindex="-1"></a></span>
<span id="cb335-65"><a href="on-your-own-5.html#cb335-65" tabindex="-1"></a>  </span>
<span id="cb335-66"><a href="on-your-own-5.html#cb335-66" tabindex="-1"></a><span class="fu">write.csv</span>(mon_obs, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>,independent ,<span class="st">&quot;min_independent_monthly_observations.csv&quot;</span>), <span class="at">row.names =</span> F) </span>
<span id="cb335-67"><a href="on-your-own-5.html#cb335-67" tabindex="-1"></a></span>
<span id="cb335-68"><a href="on-your-own-5.html#cb335-68" tabindex="-1"></a><span class="fu">write.csv</span>(mon_count, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>,independent ,<span class="st">&quot;min_independent_monthly_counts.csv&quot;</span>), <span class="at">row.names =</span> F) </span>
<span id="cb335-69"><a href="on-your-own-5.html#cb335-69" tabindex="-1"></a></span>
<span id="cb335-70"><a href="on-your-own-5.html#cb335-70" tabindex="-1"></a><span class="do">### Weekly </span></span>
<span id="cb335-71"><a href="on-your-own-5.html#cb335-71" tabindex="-1"></a></span>
<span id="cb335-72"><a href="on-your-own-5.html#cb335-72" tabindex="-1"></a><span class="co"># Weekly format</span></span>
<span id="cb335-73"><a href="on-your-own-5.html#cb335-73" tabindex="-1"></a>  <span class="co"># Station / Month / days / Covariates / Species      </span></span>
<span id="cb335-74"><a href="on-your-own-5.html#cb335-74" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> row_lookup</span>
<span id="cb335-75"><a href="on-your-own-5.html#cb335-75" tabindex="-1"></a>  <span class="co"># Simplify the date to year-week</span></span>
<span id="cb335-76"><a href="on-your-own-5.html#cb335-76" tabindex="-1"></a>  tmp<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">strftime</span>(tmp<span class="sc">$</span>date, <span class="at">format =</span> <span class="st">&quot;%Y-W%U&quot;</span>)</span>
<span id="cb335-77"><a href="on-your-own-5.html#cb335-77" tabindex="-1"></a>  <span class="co"># The way this is coded is the counter W01 starts at the first Sunday of the year, everything before that is W00. Weeks do not roll across years.</span></span>
<span id="cb335-78"><a href="on-your-own-5.html#cb335-78" tabindex="-1"></a>  </span>
<span id="cb335-79"><a href="on-your-own-5.html#cb335-79" tabindex="-1"></a>  <span class="co"># Calculate the number of days in each week  </span></span>
<span id="cb335-80"><a href="on-your-own-5.html#cb335-80" tabindex="-1"></a>  week_obs <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span> </span>
<span id="cb335-81"><a href="on-your-own-5.html#cb335-81" tabindex="-1"></a>      <span class="fu">group_by</span>(placename,date ) <span class="sc">%&gt;%</span></span>
<span id="cb335-82"><a href="on-your-own-5.html#cb335-82" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">days =</span> <span class="fu">n</span>())</span>
<span id="cb335-83"><a href="on-your-own-5.html#cb335-83" tabindex="-1"></a>  </span>
<span id="cb335-84"><a href="on-your-own-5.html#cb335-84" tabindex="-1"></a>  <span class="co"># Convert to a data frame</span></span>
<span id="cb335-85"><a href="on-your-own-5.html#cb335-85" tabindex="-1"></a>  week_obs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(week_obs)</span>
<span id="cb335-86"><a href="on-your-own-5.html#cb335-86" tabindex="-1"></a>  </span>
<span id="cb335-87"><a href="on-your-own-5.html#cb335-87" tabindex="-1"></a>  <span class="co"># Add species columns  </span></span>
<span id="cb335-88"><a href="on-your-own-5.html#cb335-88" tabindex="-1"></a>  week_obs[, <span class="fu">levels</span>(ind_dat<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb335-89"><a href="on-your-own-5.html#cb335-89" tabindex="-1"></a>  </span>
<span id="cb335-90"><a href="on-your-own-5.html#cb335-90" tabindex="-1"></a>  <span class="co"># Duplicate for counts</span></span>
<span id="cb335-91"><a href="on-your-own-5.html#cb335-91" tabindex="-1"></a>  week_count <span class="ot">&lt;-</span> week_obs</span>
<span id="cb335-92"><a href="on-your-own-5.html#cb335-92" tabindex="-1"></a>  </span>
<span id="cb335-93"><a href="on-your-own-5.html#cb335-93" tabindex="-1"></a>  <span class="co"># For each week, count the number of individuals/observations</span></span>
<span id="cb335-94"><a href="on-your-own-5.html#cb335-94" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(week_obs))</span>
<span id="cb335-95"><a href="on-your-own-5.html#cb335-95" tabindex="-1"></a>    {</span>
<span id="cb335-96"><a href="on-your-own-5.html#cb335-96" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> ind_dat[ind_dat<span class="sc">$</span>placename<span class="sc">==</span>week_obs<span class="sc">$</span>placename[i] <span class="sc">&amp;</span> <span class="fu">strftime</span>(ind_dat<span class="sc">$</span>timestamp, <span class="at">format =</span> <span class="st">&quot;%Y-W%U&quot;</span>)<span class="sc">==</span> week_obs<span class="sc">$</span>date[i],]</span>
<span id="cb335-97"><a href="on-your-own-5.html#cb335-97" tabindex="-1"></a>      </span>
<span id="cb335-98"><a href="on-your-own-5.html#cb335-98" tabindex="-1"></a>      tmp_stats <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(sp, <span class="at">.drop=</span>F) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">obs=</span><span class="fu">n</span>(), <span class="at">count=</span><span class="fu">sum</span>(animal_count))</span>
<span id="cb335-99"><a href="on-your-own-5.html#cb335-99" tabindex="-1"></a>      </span>
<span id="cb335-100"><a href="on-your-own-5.html#cb335-100" tabindex="-1"></a>      week_obs[i,<span class="fu">as.character</span>(tmp_stats<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> tmp_stats<span class="sc">$</span>obs</span>
<span id="cb335-101"><a href="on-your-own-5.html#cb335-101" tabindex="-1"></a>      week_count[i,<span class="fu">as.character</span>(tmp_stats<span class="sc">$</span>sp)] <span class="ot">&lt;-</span> tmp_stats<span class="sc">$</span>count</span>
<span id="cb335-102"><a href="on-your-own-5.html#cb335-102" tabindex="-1"></a>      </span>
<span id="cb335-103"><a href="on-your-own-5.html#cb335-103" tabindex="-1"></a>    }</span>
<span id="cb335-104"><a href="on-your-own-5.html#cb335-104" tabindex="-1"></a></span>
<span id="cb335-105"><a href="on-your-own-5.html#cb335-105" tabindex="-1"></a><span class="fu">write.csv</span>(week_obs, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>,independent ,<span class="st">&quot;min_independent_weekly_observations.csv&quot;</span>), <span class="at">row.names =</span> F) </span>
<span id="cb335-106"><a href="on-your-own-5.html#cb335-106" tabindex="-1"></a></span>
<span id="cb335-107"><a href="on-your-own-5.html#cb335-107" tabindex="-1"></a><span class="fu">write.csv</span>(week_count, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,ind_dat<span class="sc">$</span>project_id[<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>,independent ,<span class="st">&quot;min_independent_weekly_counts.csv&quot;</span>), <span class="at">row.names =</span> F) </span></code></pre></div>
</div>
<div id="check-analysis-dataframe-counts" class="section level3 hasAnchor" number="15.1.15">
<h3><span class="header-section-number">15.1.15</span> Check analysis dataframe counts<a href="on-your-own-5.html#check-analysis-dataframe-counts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb336"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb336-1"><a href="on-your-own-5.html#cb336-1" tabindex="-1"></a><span class="co"># Do an final check of the counts</span></span>
<span id="cb336-2"><a href="on-your-own-5.html#cb336-2" tabindex="-1"></a></span>
<span id="cb336-3"><a href="on-your-own-5.html#cb336-3" tabindex="-1"></a></span>
<span id="cb336-4"><a href="on-your-own-5.html#cb336-4" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">data.frame</span>(<span class="st">&quot;Time&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Total&quot;</span>, <span class="st">&quot;Monthly&quot;</span>, <span class="st">&quot;Weekly&quot;</span>)),</span>
<span id="cb336-5"><a href="on-your-own-5.html#cb336-5" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">colSums</span>(total_obs[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(total_obs)]),</span>
<span id="cb336-6"><a href="on-your-own-5.html#cb336-6" tabindex="-1"></a><span class="fu">colSums</span>(mon_obs[,<span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(mon_obs)]),</span>
<span id="cb336-7"><a href="on-your-own-5.html#cb336-7" tabindex="-1"></a><span class="fu">colSums</span>(week_obs[,<span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(week_obs)])))</span>
<span id="cb336-8"><a href="on-your-own-5.html#cb336-8" tabindex="-1"></a></span>
<span id="cb336-9"><a href="on-your-own-5.html#cb336-9" tabindex="-1"></a>tmp <span class="sc">%&gt;%</span></span>
<span id="cb336-10"><a href="on-your-own-5.html#cb336-10" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb336-11"><a href="on-your-own-5.html#cb336-11" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb336-12"><a href="on-your-own-5.html#cb336-12" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> T, <span class="at">border_right =</span> T)<span class="sc">%&gt;%</span> </span>
<span id="cb336-13"><a href="on-your-own-5.html#cb336-13" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="add-your-covariates" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Add your covariates<a href="on-your-own-5.html#add-your-covariates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb337"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb337-1"><a href="on-your-own-5.html#cb337-1" tabindex="-1"></a><span class="co"># LOad the packages</span></span>
<span id="cb337-2"><a href="on-your-own-5.html#cb337-2" tabindex="-1"></a><span class="fu">library</span>(kableExtra);<span class="fu">library</span>(dplyr); <span class="fu">library</span>(sf); <span class="fu">library</span>(modisfast); <span class="fu">library</span>(lubridate); <span class="fu">library</span>(corrplot); <span class="fu">library</span>(traitdata); <span class="fu">library</span>(terra); <span class="fu">library</span>(osmdata); <span class="fu">library</span>(elevatr)</span></code></pre></div>
<div id="species-traits-1" class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Species Traits<a href="on-your-own-5.html#species-traits-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb338"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb338-1"><a href="on-your-own-5.html#cb338-1" tabindex="-1"></a><span class="co"># Start by reading in your species list</span></span>
<span id="cb338-2"><a href="on-your-own-5.html#cb338-2" tabindex="-1"></a>sp_summary <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,pro<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_species_list.csv&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb338-3"><a href="on-your-own-5.html#cb338-3" tabindex="-1"></a>locs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,pro<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_camera_locations.csv&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb338-4"><a href="on-your-own-5.html#cb338-4" tabindex="-1"></a></span>
<span id="cb338-5"><a href="on-your-own-5.html#cb338-5" tabindex="-1"></a><span class="co"># Species traits</span></span>
<span id="cb338-6"><a href="on-your-own-5.html#cb338-6" tabindex="-1"></a><span class="fu">library</span>(traitdata)</span>
<span id="cb338-7"><a href="on-your-own-5.html#cb338-7" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;elton_mammals&quot;</span>)</span>
<span id="cb338-8"><a href="on-your-own-5.html#cb338-8" tabindex="-1"></a>elton_mammals<span class="sc">$</span>sp <span class="ot">&lt;-</span> <span class="fu">paste0</span>(elton_mammals<span class="sc">$</span>Genus,<span class="st">&quot;.&quot;</span> ,elton_mammals<span class="sc">$</span>Species)</span>
<span id="cb338-9"><a href="on-your-own-5.html#cb338-9" tabindex="-1"></a></span>
<span id="cb338-10"><a href="on-your-own-5.html#cb338-10" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> elton_mammals[, <span class="fu">c</span>(<span class="st">&quot;sp&quot;</span>,<span class="st">&quot;BodyMass.Value&quot;</span>, <span class="st">&quot;Activity.Nocturnal&quot;</span>, <span class="st">&quot;Activity.Crepuscular&quot;</span>,   <span class="st">&quot;Activity.Diurnal&quot;</span>)]</span>
<span id="cb338-11"><a href="on-your-own-5.html#cb338-11" tabindex="-1"></a></span>
<span id="cb338-12"><a href="on-your-own-5.html#cb338-12" tabindex="-1"></a><span class="co"># Lets rename the columns to make them more usable</span></span>
<span id="cb338-13"><a href="on-your-own-5.html#cb338-13" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> tmp <span class="sc">%&gt;%</span> <span class="fu">rename</span>(</span>
<span id="cb338-14"><a href="on-your-own-5.html#cb338-14" tabindex="-1"></a>              <span class="at">mass_g =</span> BodyMass.Value,</span>
<span id="cb338-15"><a href="on-your-own-5.html#cb338-15" tabindex="-1"></a>              <span class="at">act_noct =</span> Activity.Nocturnal,</span>
<span id="cb338-16"><a href="on-your-own-5.html#cb338-16" tabindex="-1"></a>              <span class="at">act_crep =</span> Activity.Crepuscular,</span>
<span id="cb338-17"><a href="on-your-own-5.html#cb338-17" tabindex="-1"></a>              <span class="at">act_diur =</span> Activity.Diurnal)</span>
<span id="cb338-18"><a href="on-your-own-5.html#cb338-18" tabindex="-1"></a></span>
<span id="cb338-19"><a href="on-your-own-5.html#cb338-19" tabindex="-1"></a>sp_summary <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sp_summary, tmp)</span></code></pre></div>
<p><strong>QUESTION</strong> Are there any missing values you need to fill in?</p>
<p>Dont worry about adding it right now - carry on!</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb339-1"><a href="on-your-own-5.html#cb339-1" tabindex="-1"></a><span class="fu">write.csv</span>(sp_summary, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>, locs<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_species_list.csv&quot;</span>), <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
</div>
<div id="spatial-data" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Spatial data<a href="on-your-own-5.html#spatial-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="convert-to-simple-features" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Convert to simple features<a href="on-your-own-5.html#convert-to-simple-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb340"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb340-1"><a href="on-your-own-5.html#cb340-1" tabindex="-1"></a><span class="co"># Spatial covariates</span></span>
<span id="cb340-2"><a href="on-your-own-5.html#cb340-2" tabindex="-1"></a>locs_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(locs,                              <span class="co"># We specify the dataframe </span></span>
<span id="cb340-3"><a href="on-your-own-5.html#cb340-3" tabindex="-1"></a>                    <span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>), <span class="co"># The XY coordinates</span></span>
<span id="cb340-4"><a href="on-your-own-5.html#cb340-4" tabindex="-1"></a>                    <span class="at">crs=</span><span class="dv">4326</span>)                          <span class="co"># And the projection code</span></span></code></pre></div>
</div>
<div id="get-elevation-data" class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> Get elevation data<a href="on-your-own-5.html#get-elevation-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb341"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb341-1"><a href="on-your-own-5.html#cb341-1" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb341-2"><a href="on-your-own-5.html#cb341-2" tabindex="-1"></a><span class="co"># Elevation </span></span>
<span id="cb341-3"><a href="on-your-own-5.html#cb341-3" tabindex="-1"></a></span>
<span id="cb341-4"><a href="on-your-own-5.html#cb341-4" tabindex="-1"></a><span class="fu">library</span>(elevatr)</span>
<span id="cb341-5"><a href="on-your-own-5.html#cb341-5" tabindex="-1"></a>locs_sf <span class="ot">&lt;-</span> <span class="fu">get_elev_point</span>(locs_sf, </span>
<span id="cb341-6"><a href="on-your-own-5.html#cb341-6" tabindex="-1"></a>                          <span class="at">src=</span><span class="st">&quot;aws&quot;</span>, <span class="co">#Amazon Web Service Terrain Tiles - available globally</span></span>
<span id="cb341-7"><a href="on-your-own-5.html#cb341-7" tabindex="-1"></a>                          <span class="at">z =</span> <span class="dv">12</span>)  <span class="co"># z specifies the zoom level, the lower the value the faster the code runs, but the coarser the elevation values are</span></span>
<span id="cb341-8"><a href="on-your-own-5.html#cb341-8" tabindex="-1"></a></span>
<span id="cb341-9"><a href="on-your-own-5.html#cb341-9" tabindex="-1"></a><span class="fu">boxplot</span>(locs_sf<span class="sc">$</span>elevation)</span></code></pre></div>
</div>
<div id="open-street-map-data" class="section level3 hasAnchor" number="15.3.3">
<h3><span class="header-section-number">15.3.3</span> Open street map data<a href="on-your-own-5.html#open-street-map-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb342"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb342-1"><a href="on-your-own-5.html#cb342-1" tabindex="-1"></a><span class="do">#######</span></span>
<span id="cb342-2"><a href="on-your-own-5.html#cb342-2" tabindex="-1"></a><span class="co"># Distance to water (there are no roads here)</span></span>
<span id="cb342-3"><a href="on-your-own-5.html#cb342-3" tabindex="-1"></a></span>
<span id="cb342-4"><a href="on-your-own-5.html#cb342-4" tabindex="-1"></a><span class="fu">library</span>(osmdata)</span>
<span id="cb342-5"><a href="on-your-own-5.html#cb342-5" tabindex="-1"></a>aoi <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">st_buffer</span>(locs_sf, <span class="dv">10000</span>)) <span class="co"># Units are in meters </span></span>
<span id="cb342-6"><a href="on-your-own-5.html#cb342-6" tabindex="-1"></a></span>
<span id="cb342-7"><a href="on-your-own-5.html#cb342-7" tabindex="-1"></a>water <span class="ot">&lt;-</span> <span class="fu">opq</span>(aoi) <span class="sc">%&gt;%</span></span>
<span id="cb342-8"><a href="on-your-own-5.html#cb342-8" tabindex="-1"></a>           <span class="fu">add_osm_feature</span>(<span class="at">key =</span> <span class="st">&#39;natural&#39;</span>, <span class="at">value =</span> <span class="st">&#39;water&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb342-9"><a href="on-your-own-5.html#cb342-9" tabindex="-1"></a>           <span class="fu">osmdata_sf</span>()</span>
<span id="cb342-10"><a href="on-your-own-5.html#cb342-10" tabindex="-1"></a></span>
<span id="cb342-11"><a href="on-your-own-5.html#cb342-11" tabindex="-1"></a><span class="co"># THERE IS NO OPEN STREET MAP DATA FOR THIS AREA - ARGH</span></span></code></pre></div>
</div>
<div id="ndvi" class="section level3 hasAnchor" number="15.3.4">
<h3><span class="header-section-number">15.3.4</span> NDVI<a href="on-your-own-5.html#ndvi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb343"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb343-1"><a href="on-your-own-5.html#cb343-1" tabindex="-1"></a><span class="do">#######</span></span>
<span id="cb343-2"><a href="on-your-own-5.html#cb343-2" tabindex="-1"></a><span class="co"># NDVI</span></span>
<span id="cb343-3"><a href="on-your-own-5.html#cb343-3" tabindex="-1"></a></span>
<span id="cb343-4"><a href="on-your-own-5.html#cb343-4" tabindex="-1"></a><span class="fu">library</span>(modisfast)</span>
<span id="cb343-5"><a href="on-your-own-5.html#cb343-5" tabindex="-1"></a></span>
<span id="cb343-6"><a href="on-your-own-5.html#cb343-6" tabindex="-1"></a>log <span class="ot">&lt;-</span> <span class="fu">mf_login</span>(<span class="at">credentials =</span> <span class="fu">c</span>(<span class="st">&quot;cameratrap_course&quot;</span>, <span class="st">&quot;CMI_Revelstoke_2025&quot;</span>)) <span class="co"># set your own EOSDIS username and password</span></span>
<span id="cb343-7"><a href="on-your-own-5.html#cb343-7" tabindex="-1"></a></span>
<span id="cb343-8"><a href="on-your-own-5.html#cb343-8" tabindex="-1"></a><span class="co"># Create aoi if sf format</span></span>
<span id="cb343-9"><a href="on-your-own-5.html#cb343-9" tabindex="-1"></a>aoi_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">id =</span> <span class="st">&quot;los_amigos&quot;</span>, <span class="at">geom =</span> <span class="fu">st_as_sfc</span>(aoi), <span class="at">wkt =</span> <span class="st">&quot;geom&quot;</span>, <span class="at">crs =</span> <span class="dv">4326</span>)) <span class="co"># a ROI of interest, format sf polygon</span></span>
<span id="cb343-10"><a href="on-your-own-5.html#cb343-10" tabindex="-1"></a></span>
<span id="cb343-11"><a href="on-your-own-5.html#cb343-11" tabindex="-1"></a><span class="co"># MODIS collections and variables (bands) of interest</span></span>
<span id="cb343-12"><a href="on-your-own-5.html#cb343-12" tabindex="-1"></a>collection <span class="ot">&lt;-</span> <span class="st">&quot;MOD13Q1.061&quot;</span> <span class="co"># run mf_list_collections() for an exhaustive list of collections available</span></span>
<span id="cb343-13"><a href="on-your-own-5.html#cb343-13" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;_250m_16_days_NDVI&quot;</span>) <span class="co"># run mf_list_variables(&quot;MOD13Q1.061&quot;) for an exhaustive list of variables available for the collection &quot;MOD13A3.061&quot;</span></span>
<span id="cb343-14"><a href="on-your-own-5.html#cb343-14" tabindex="-1"></a></span>
<span id="cb343-15"><a href="on-your-own-5.html#cb343-15" tabindex="-1"></a><span class="co"># Specify the time range - we will use a winter-summer transition</span></span>
<span id="cb343-16"><a href="on-your-own-5.html#cb343-16" tabindex="-1"></a>time_range <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;2022-01-01&quot;</span>, <span class="st">&quot;2022-02-28&quot;</span>)) <span class="co"># a time range of interest</span></span>
<span id="cb343-17"><a href="on-your-own-5.html#cb343-17" tabindex="-1"></a></span>
<span id="cb343-18"><a href="on-your-own-5.html#cb343-18" tabindex="-1"></a><span class="do">## Get the URLs of the data</span></span>
<span id="cb343-19"><a href="on-your-own-5.html#cb343-19" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">mf_get_url</span>(</span>
<span id="cb343-20"><a href="on-your-own-5.html#cb343-20" tabindex="-1"></a>  <span class="at">collection =</span> collection,</span>
<span id="cb343-21"><a href="on-your-own-5.html#cb343-21" tabindex="-1"></a>  <span class="at">variables =</span> variables,</span>
<span id="cb343-22"><a href="on-your-own-5.html#cb343-22" tabindex="-1"></a>  <span class="at">roi =</span> aoi_sf,</span>
<span id="cb343-23"><a href="on-your-own-5.html#cb343-23" tabindex="-1"></a>  <span class="at">time_range =</span> time_range</span>
<span id="cb343-24"><a href="on-your-own-5.html#cb343-24" tabindex="-1"></a>)</span>
<span id="cb343-25"><a href="on-your-own-5.html#cb343-25" tabindex="-1"></a></span>
<span id="cb343-26"><a href="on-your-own-5.html#cb343-26" tabindex="-1"></a><span class="do">## Download the data. By default the data is downloaded in a temporary directory, but you can specify a folder</span></span>
<span id="cb343-27"><a href="on-your-own-5.html#cb343-27" tabindex="-1"></a>res_dl <span class="ot">&lt;-</span> <span class="fu">mf_download_data</span>(urls, <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb343-28"><a href="on-your-own-5.html#cb343-28" tabindex="-1"></a></span>
<span id="cb343-29"><a href="on-your-own-5.html#cb343-29" tabindex="-1"></a><span class="co"># Import it into R</span></span>
<span id="cb343-30"><a href="on-your-own-5.html#cb343-30" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">mf_import_data</span>(</span>
<span id="cb343-31"><a href="on-your-own-5.html#cb343-31" tabindex="-1"></a>  <span class="at">path =</span> <span class="fu">dirname</span>(res_dl<span class="sc">$</span>destfile[<span class="dv">1</span>]),</span>
<span id="cb343-32"><a href="on-your-own-5.html#cb343-32" tabindex="-1"></a>  <span class="at">collection =</span> collection,</span>
<span id="cb343-33"><a href="on-your-own-5.html#cb343-33" tabindex="-1"></a>  <span class="at">proj_epsg =</span> <span class="dv">4326</span></span>
<span id="cb343-34"><a href="on-your-own-5.html#cb343-34" tabindex="-1"></a>)</span>
<span id="cb343-35"><a href="on-your-own-5.html#cb343-35" tabindex="-1"></a></span>
<span id="cb343-36"><a href="on-your-own-5.html#cb343-36" tabindex="-1"></a><span class="co"># Plot the resulting NDVI data</span></span>
<span id="cb343-37"><a href="on-your-own-5.html#cb343-37" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(r, <span class="at">col =</span> <span class="fu">rev</span>(<span class="fu">terrain.colors</span>(<span class="dv">20</span>)), </span>
<span id="cb343-38"><a href="on-your-own-5.html#cb343-38" tabindex="-1"></a>            <span class="at">range=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="co"># Specify the range of values you want to plot</span></span>
<span id="cb343-39"><a href="on-your-own-5.html#cb343-39" tabindex="-1"></a></span>
<span id="cb343-40"><a href="on-your-own-5.html#cb343-40" tabindex="-1"></a><span class="co"># Extract the data to camera locations</span></span>
<span id="cb343-41"><a href="on-your-own-5.html#cb343-41" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(r, locs_sf, <span class="at">fun=</span>mean, <span class="at">ID=</span>F) <span class="co"># Extract - each layer will become its own column</span></span>
<span id="cb343-42"><a href="on-your-own-5.html#cb343-42" tabindex="-1"></a>locs_sf<span class="sc">$</span>mean_ndvi <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(tmp) <span class="co"># take the mean of each column</span></span>
<span id="cb343-43"><a href="on-your-own-5.html#cb343-43" tabindex="-1"></a></span>
<span id="cb343-44"><a href="on-your-own-5.html#cb343-44" tabindex="-1"></a><span class="do">#######################################</span></span>
<span id="cb343-45"><a href="on-your-own-5.html#cb343-45" tabindex="-1"></a><span class="co"># Convert it back to a dataframe</span></span>
<span id="cb343-46"><a href="on-your-own-5.html#cb343-46" tabindex="-1"></a>locs_sf<span class="sc">$</span>geometry <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb343-47"><a href="on-your-own-5.html#cb343-47" tabindex="-1"></a></span>
<span id="cb343-48"><a href="on-your-own-5.html#cb343-48" tabindex="-1"></a>locs <span class="ot">&lt;-</span> <span class="fu">left_join</span>(locs, locs_sf)</span>
<span id="cb343-49"><a href="on-your-own-5.html#cb343-49" tabindex="-1"></a></span>
<span id="cb343-50"><a href="on-your-own-5.html#cb343-50" tabindex="-1"></a><span class="co"># Write the dataset</span></span>
<span id="cb343-51"><a href="on-your-own-5.html#cb343-51" tabindex="-1"></a></span>
<span id="cb343-52"><a href="on-your-own-5.html#cb343-52" tabindex="-1"></a><span class="fu">write.csv</span>(locs, <span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>, locs<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_camera_locations_and_covariates.csv&quot;</span>), <span class="at">row.names=</span>F)</span></code></pre></div>
</div>
</div>
<div id="data-exploration" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Data exploration<a href="on-your-own-5.html#data-exploration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="final-map" class="section level3 hasAnchor" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Final map<a href="on-your-own-5.html#final-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb344"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb344-1"><a href="on-your-own-5.html#cb344-1" tabindex="-1"></a>list.of.packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;kableExtra&quot;</span>, <span class="st">&quot;tidyr&quot;</span>, <span class="st">&quot;leaflet&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;viridis&quot;</span>, <span class="st">&quot;corrplot&quot;</span>, <span class="st">&quot;lubridate&quot;</span>, <span class="st">&quot;plotly&quot;</span>)</span>
<span id="cb344-2"><a href="on-your-own-5.html#cb344-2" tabindex="-1"></a></span>
<span id="cb344-3"><a href="on-your-own-5.html#cb344-3" tabindex="-1"></a>new.packages <span class="ot">&lt;-</span> list.of.packages[<span class="sc">!</span>(list.of.packages <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[,<span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb344-4"><a href="on-your-own-5.html#cb344-4" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(new.packages)) <span class="fu">install.packages</span>(new.packages)</span>
<span id="cb344-5"><a href="on-your-own-5.html#cb344-5" tabindex="-1"></a><span class="fu">lapply</span>(list.of.packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb344-6"><a href="on-your-own-5.html#cb344-6" tabindex="-1"></a></span>
<span id="cb344-7"><a href="on-your-own-5.html#cb344-7" tabindex="-1"></a><span class="co"># Final locations plot</span></span>
<span id="cb344-8"><a href="on-your-own-5.html#cb344-8" tabindex="-1"></a></span>
<span id="cb344-9"><a href="on-your-own-5.html#cb344-9" tabindex="-1"></a>locs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,pro<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_camera_locations_and_covariates.csv&quot;</span>))</span>
<span id="cb344-10"><a href="on-your-own-5.html#cb344-10" tabindex="-1"></a></span>
<span id="cb344-11"><a href="on-your-own-5.html#cb344-11" tabindex="-1"></a><span class="co"># If you want to color by a category do it here:</span></span>
<span id="cb344-12"><a href="on-your-own-5.html#cb344-12" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="st">&quot;feature_type&quot;</span></span>
<span id="cb344-13"><a href="on-your-own-5.html#cb344-13" tabindex="-1"></a><span class="co"># First lets choose a category to color</span></span>
<span id="cb344-14"><a href="on-your-own-5.html#cb344-14" tabindex="-1"></a>locs[,category] <span class="ot">&lt;-</span> <span class="fu">factor</span>(locs[,category])</span>
<span id="cb344-15"><a href="on-your-own-5.html#cb344-15" tabindex="-1"></a>col.cat <span class="ot">&lt;-</span> <span class="fu">turbo</span>(<span class="fu">length</span>(<span class="fu">levels</span>(locs[,category])))</span>
<span id="cb344-16"><a href="on-your-own-5.html#cb344-16" tabindex="-1"></a><span class="co"># Add it to the dataframe</span></span>
<span id="cb344-17"><a href="on-your-own-5.html#cb344-17" tabindex="-1"></a>locs<span class="sc">$</span>colours <span class="ot">&lt;-</span> col.cat[locs[,category]]</span>
<span id="cb344-18"><a href="on-your-own-5.html#cb344-18" tabindex="-1"></a></span>
<span id="cb344-19"><a href="on-your-own-5.html#cb344-19" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb344-20"><a href="on-your-own-5.html#cb344-20" tabindex="-1"></a>  <span class="co"># Add a satellite image layer</span></span>
<span id="cb344-21"><a href="on-your-own-5.html#cb344-21" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldImagery, <span class="at">group=</span><span class="st">&quot;Satellite&quot;</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb344-22"><a href="on-your-own-5.html#cb344-22" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldTopoMap, <span class="at">group=</span><span class="st">&quot;Base&quot;</span>) <span class="sc">%&gt;%</span>     </span>
<span id="cb344-23"><a href="on-your-own-5.html#cb344-23" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng=</span>locs<span class="sc">$</span>longitude, <span class="at">lat=</span>locs<span class="sc">$</span>latitude,</span>
<span id="cb344-24"><a href="on-your-own-5.html#cb344-24" tabindex="-1"></a>                   <span class="co"># Color the markers depending on the &#39;feature type&#39;</span></span>
<span id="cb344-25"><a href="on-your-own-5.html#cb344-25" tabindex="-1"></a>                   <span class="at">color=</span>locs<span class="sc">$</span>colours,</span>
<span id="cb344-26"><a href="on-your-own-5.html#cb344-26" tabindex="-1"></a>                   <span class="co"># Add a popup of the deployment code </span></span>
<span id="cb344-27"><a href="on-your-own-5.html#cb344-27" tabindex="-1"></a>                   <span class="at">popup=</span><span class="fu">paste</span>(locs<span class="sc">$</span>placename, locs[,category])) <span class="sc">%&gt;%</span></span>
<span id="cb344-28"><a href="on-your-own-5.html#cb344-28" tabindex="-1"></a>  <span class="co"># Add a legend explaining what is going on</span></span>
<span id="cb344-29"><a href="on-your-own-5.html#cb344-29" tabindex="-1"></a>  <span class="fu">addLegend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">colors =</span> col.cat,  <span class="at">labels =</span> <span class="fu">levels</span>(locs[,category]),</span>
<span id="cb344-30"><a href="on-your-own-5.html#cb344-30" tabindex="-1"></a>    <span class="at">title =</span> category,</span>
<span id="cb344-31"><a href="on-your-own-5.html#cb344-31" tabindex="-1"></a>    <span class="at">labFormat =</span> <span class="fu">labelFormat</span>(<span class="at">prefix =</span> <span class="st">&quot;$&quot;</span>),</span>
<span id="cb344-32"><a href="on-your-own-5.html#cb344-32" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="dv">1</span></span>
<span id="cb344-33"><a href="on-your-own-5.html#cb344-33" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb344-34"><a href="on-your-own-5.html#cb344-34" tabindex="-1"></a>  <span class="co"># add a layer control box to toggle between the layers</span></span>
<span id="cb344-35"><a href="on-your-own-5.html#cb344-35" tabindex="-1"></a>  <span class="fu">addLayersControl</span>(</span>
<span id="cb344-36"><a href="on-your-own-5.html#cb344-36" tabindex="-1"></a>    <span class="at">baseGroups =</span> <span class="fu">c</span>(<span class="st">&quot;Satellite&quot;</span>, <span class="st">&quot;Base&quot;</span>),</span>
<span id="cb344-37"><a href="on-your-own-5.html#cb344-37" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">layersControlOptions</span>(<span class="at">collapsed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb344-38"><a href="on-your-own-5.html#cb344-38" tabindex="-1"></a>  )</span>
<span id="cb344-39"><a href="on-your-own-5.html#cb344-39" tabindex="-1"></a>m</span></code></pre></div>
</div>
<div id="detection-summary" class="section level3 hasAnchor" number="15.4.2">
<h3><span class="header-section-number">15.4.2</span> Detection summary<a href="on-your-own-5.html#detection-summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb345"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb345-1"><a href="on-your-own-5.html#cb345-1" tabindex="-1"></a>sp_summary <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,pro<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_species_list.csv&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb345-2"><a href="on-your-own-5.html#cb345-2" tabindex="-1"></a>total_obs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,pro<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_30min_independent_total_observations.csv&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb345-3"><a href="on-your-own-5.html#cb345-3" tabindex="-1"></a></span>
<span id="cb345-4"><a href="on-your-own-5.html#cb345-4" tabindex="-1"></a><span class="co"># Convert to long</span></span>
<span id="cb345-5"><a href="on-your-own-5.html#cb345-5" tabindex="-1"></a>long_obs <span class="ot">&lt;-</span> total_obs <span class="sc">%&gt;%</span> </span>
<span id="cb345-6"><a href="on-your-own-5.html#cb345-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>sp_summary<span class="sc">$</span>sp,  <span class="co"># The columns we want to create into rows - species</span></span>
<span id="cb345-7"><a href="on-your-own-5.html#cb345-7" tabindex="-1"></a>               <span class="at">names_to=</span><span class="st">&quot;sp&quot;</span>,       <span class="co"># What we what the number column to be called</span></span>
<span id="cb345-8"><a href="on-your-own-5.html#cb345-8" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="co"># Takes the values in the species columns and calls them `count`</span></span>
<span id="cb345-9"><a href="on-your-own-5.html#cb345-9" tabindex="-1"></a></span>
<span id="cb345-10"><a href="on-your-own-5.html#cb345-10" tabindex="-1"></a></span>
<span id="cb345-11"><a href="on-your-own-5.html#cb345-11" tabindex="-1"></a><span class="co"># We can them summaries those using dplyr</span></span>
<span id="cb345-12"><a href="on-your-own-5.html#cb345-12" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> long_obs <span class="sc">%&gt;%</span>                   <span class="co"># Take the long observation data frame `long_obs` </span></span>
<span id="cb345-13"><a href="on-your-own-5.html#cb345-13" tabindex="-1"></a>          <span class="fu">group_by</span>(sp) <span class="sc">%&gt;%</span>            <span class="co"># Group by species</span></span>
<span id="cb345-14"><a href="on-your-own-5.html#cb345-14" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">sum</span>(count)) <span class="co"># Sum all the independent observations</span></span>
<span id="cb345-15"><a href="on-your-own-5.html#cb345-15" tabindex="-1"></a></span>
<span id="cb345-16"><a href="on-your-own-5.html#cb345-16" tabindex="-1"></a><span class="co"># Add it to the sp_summary dataframe</span></span>
<span id="cb345-17"><a href="on-your-own-5.html#cb345-17" tabindex="-1"></a>sp_summary <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sp_summary, tmp)</span>
<span id="cb345-18"><a href="on-your-own-5.html#cb345-18" tabindex="-1"></a></span>
<span id="cb345-19"><a href="on-your-own-5.html#cb345-19" tabindex="-1"></a><span class="do">## Occupancy</span></span>
<span id="cb345-20"><a href="on-your-own-5.html#cb345-20" tabindex="-1"></a><span class="co"># We use the mutate function to mutate the column</span></span>
<span id="cb345-21"><a href="on-your-own-5.html#cb345-21" tabindex="-1"></a>total_binary <span class="ot">&lt;-</span>  total_obs <span class="sc">%&gt;%</span>    <span class="co"># The total obs dataframe              </span></span>
<span id="cb345-22"><a href="on-your-own-5.html#cb345-22" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="fu">across</span>(sp_summary<span class="sc">$</span>sp, <span class="sc">~+</span><span class="fu">as.logical</span>(.x)))  <span class="co"># across all of the species columns, make it binary</span></span>
<span id="cb345-23"><a href="on-your-own-5.html#cb345-23" tabindex="-1"></a></span>
<span id="cb345-24"><a href="on-your-own-5.html#cb345-24" tabindex="-1"></a><span class="co"># Flip the dataframe to longer - as before</span></span>
<span id="cb345-25"><a href="on-your-own-5.html#cb345-25" tabindex="-1"></a>long_bin <span class="ot">&lt;-</span> total_binary <span class="sc">%&gt;%</span> </span>
<span id="cb345-26"><a href="on-your-own-5.html#cb345-26" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span>sp_summary<span class="sc">$</span>sp, <span class="at">names_to=</span><span class="st">&quot;sp&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="co"># Takes the species names columns, and makes them unique rows with &quot;sp&quot; as the key </span></span>
<span id="cb345-27"><a href="on-your-own-5.html#cb345-27" tabindex="-1"></a></span>
<span id="cb345-28"><a href="on-your-own-5.html#cb345-28" tabindex="-1"></a><span class="co"># We can now sum the presence/absences and divide by the number of survey locations</span></span>
<span id="cb345-29"><a href="on-your-own-5.html#cb345-29" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> long_bin <span class="sc">%&gt;%</span> </span>
<span id="cb345-30"><a href="on-your-own-5.html#cb345-30" tabindex="-1"></a>  <span class="fu">group_by</span>(sp) <span class="sc">%&gt;%</span> </span>
<span id="cb345-31"><a href="on-your-own-5.html#cb345-31" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">occupancy=</span><span class="fu">sum</span>(count)<span class="sc">/</span><span class="fu">nrow</span>(locs)) <span class="co"># divided the sum by the number of sites</span></span>
<span id="cb345-32"><a href="on-your-own-5.html#cb345-32" tabindex="-1"></a></span>
<span id="cb345-33"><a href="on-your-own-5.html#cb345-33" tabindex="-1"></a><span class="co"># add the results to the sp_summary</span></span>
<span id="cb345-34"><a href="on-your-own-5.html#cb345-34" tabindex="-1"></a>sp_summary <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sp_summary, tmp)</span>
<span id="cb345-35"><a href="on-your-own-5.html#cb345-35" tabindex="-1"></a></span>
<span id="cb345-36"><a href="on-your-own-5.html#cb345-36" tabindex="-1"></a></span>
<span id="cb345-37"><a href="on-your-own-5.html#cb345-37" tabindex="-1"></a><span class="do">###########################</span></span>
<span id="cb345-38"><a href="on-your-own-5.html#cb345-38" tabindex="-1"></a><span class="co"># Comparison plot</span></span>
<span id="cb345-39"><a href="on-your-own-5.html#cb345-39" tabindex="-1"></a><span class="co"># Lets put the dataframes in a sensible order</span></span>
<span id="cb345-40"><a href="on-your-own-5.html#cb345-40" tabindex="-1"></a>sp_summary <span class="ot">&lt;-</span> sp_summary[<span class="fu">order</span>(sp_summary<span class="sc">$</span>count),]</span>
<span id="cb345-41"><a href="on-your-own-5.html#cb345-41" tabindex="-1"></a></span>
<span id="cb345-42"><a href="on-your-own-5.html#cb345-42" tabindex="-1"></a>yform <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">categoryorder =</span> <span class="st">&quot;array&quot;</span>,</span>
<span id="cb345-43"><a href="on-your-own-5.html#cb345-43" tabindex="-1"></a>              <span class="at">categoryarray =</span> sp_summary<span class="sc">$</span>sp)</span>
<span id="cb345-44"><a href="on-your-own-5.html#cb345-44" tabindex="-1"></a></span>
<span id="cb345-45"><a href="on-your-own-5.html#cb345-45" tabindex="-1"></a>xform <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Captures&quot;</span>)</span>
<span id="cb345-46"><a href="on-your-own-5.html#cb345-46" tabindex="-1"></a></span>
<span id="cb345-47"><a href="on-your-own-5.html#cb345-47" tabindex="-1"></a><span class="co"># Capture rate</span></span>
<span id="cb345-48"><a href="on-your-own-5.html#cb345-48" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> sp_summary<span class="sc">$</span>count, <span class="at">y =</span> sp_summary<span class="sc">$</span>common_name, <span class="at">type =</span> <span class="st">&#39;bar&#39;</span>, <span class="at">orientation =</span> <span class="st">&#39;h&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb345-49"><a href="on-your-own-5.html#cb345-49" tabindex="-1"></a> <span class="fu">layout</span>(<span class="at">yaxis =</span> yform, <span class="at">xaxis=</span>xform)</span>
<span id="cb345-50"><a href="on-your-own-5.html#cb345-50" tabindex="-1"></a></span>
<span id="cb345-51"><a href="on-your-own-5.html#cb345-51" tabindex="-1"></a>yform <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">categoryorder =</span> <span class="st">&quot;array&quot;</span>,</span>
<span id="cb345-52"><a href="on-your-own-5.html#cb345-52" tabindex="-1"></a>              <span class="at">categoryarray =</span> sp_summary<span class="sc">$</span>sp,</span>
<span id="cb345-53"><a href="on-your-own-5.html#cb345-53" tabindex="-1"></a>              <span class="at">showticklabels=</span>F)</span>
<span id="cb345-54"><a href="on-your-own-5.html#cb345-54" tabindex="-1"></a>xform <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&quot;Occupancy&quot;</span>)</span>
<span id="cb345-55"><a href="on-your-own-5.html#cb345-55" tabindex="-1"></a></span>
<span id="cb345-56"><a href="on-your-own-5.html#cb345-56" tabindex="-1"></a></span>
<span id="cb345-57"><a href="on-your-own-5.html#cb345-57" tabindex="-1"></a><span class="co"># Occupancy</span></span>
<span id="cb345-58"><a href="on-your-own-5.html#cb345-58" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">x =</span> sp_summary<span class="sc">$</span>occupancy, <span class="at">y =</span> sp_summary<span class="sc">$</span>common_name, <span class="at">type =</span> <span class="st">&#39;bar&#39;</span>, <span class="at">orientation =</span> <span class="st">&#39;h&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb345-59"><a href="on-your-own-5.html#cb345-59" tabindex="-1"></a> <span class="fu">layout</span>(<span class="at">yaxis =</span> yform, <span class="at">xaxis=</span>xform)</span>
<span id="cb345-60"><a href="on-your-own-5.html#cb345-60" tabindex="-1"></a></span>
<span id="cb345-61"><a href="on-your-own-5.html#cb345-61" tabindex="-1"></a><span class="fu">subplot</span>(<span class="at">nrows=</span><span class="dv">1</span>,fig1, fig2, <span class="at">titleX =</span> T) <span class="co"># We could stack them on top of one another using nrows=2</span></span></code></pre></div>
<p><strong>QUESTION</strong> What does this tell you about the behavior of the target species?</p>
</div>
<div id="temporal-patterns" class="section level3 hasAnchor" number="15.4.3">
<h3><span class="header-section-number">15.4.3</span> Temporal patterns<a href="on-your-own-5.html#temporal-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb346"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb346-1"><a href="on-your-own-5.html#cb346-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb346-2"><a href="on-your-own-5.html#cb346-2" tabindex="-1"></a><span class="co"># Temporal patterns</span></span>
<span id="cb346-3"><a href="on-your-own-5.html#cb346-3" tabindex="-1"></a>mon_obs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">&quot;data/processed_data/&quot;</span>,pro<span class="sc">$</span>project_id[<span class="dv">1</span>],<span class="st">&quot;_30min_independent_monthly_observations.csv&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb346-4"><a href="on-your-own-5.html#cb346-4" tabindex="-1"></a></span>
<span id="cb346-5"><a href="on-your-own-5.html#cb346-5" tabindex="-1"></a><span class="co"># Count up the number of stations and the number of camera nights</span></span>
<span id="cb346-6"><a href="on-your-own-5.html#cb346-6" tabindex="-1"></a>mon_summary <span class="ot">&lt;-</span> mon_obs <span class="sc">%&gt;%</span>                  <span class="co"># Use the monthly observations dataframe</span></span>
<span id="cb346-7"><a href="on-your-own-5.html#cb346-7" tabindex="-1"></a>            <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span>              <span class="co"># Group by the date</span></span>
<span id="cb346-8"><a href="on-your-own-5.html#cb346-8" tabindex="-1"></a>            <span class="fu">summarise</span>(<span class="at">locs_active=</span><span class="fu">n</span>(),      <span class="co"># Count the number of active cameras</span></span>
<span id="cb346-9"><a href="on-your-own-5.html#cb346-9" tabindex="-1"></a>                      <span class="at">cam_days=</span><span class="fu">sum</span>(days))   <span class="co"># And sum the active days </span></span>
<span id="cb346-10"><a href="on-your-own-5.html#cb346-10" tabindex="-1"></a></span>
<span id="cb346-11"><a href="on-your-own-5.html#cb346-11" tabindex="-1"></a></span>
<span id="cb346-12"><a href="on-your-own-5.html#cb346-12" tabindex="-1"></a><span class="co"># Add in the species specific counts - and join it with the mon_summary dataframe</span></span>
<span id="cb346-13"><a href="on-your-own-5.html#cb346-13" tabindex="-1"></a>mon_summary <span class="ot">&lt;-</span> mon_obs <span class="sc">%&gt;%</span> </span>
<span id="cb346-14"><a href="on-your-own-5.html#cb346-14" tabindex="-1"></a>                <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span>  </span>
<span id="cb346-15"><a href="on-your-own-5.html#cb346-15" tabindex="-1"></a>                <span class="fu">summarise</span>(<span class="fu">across</span>(sp_summary<span class="sc">$</span>sp, sum, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="co"># summarise across all of </span></span>
<span id="cb346-16"><a href="on-your-own-5.html#cb346-16" tabindex="-1"></a>                                                                      <span class="co"># the species columns </span></span>
<span id="cb346-17"><a href="on-your-own-5.html#cb346-17" tabindex="-1"></a>                <span class="fu">left_join</span>(<span class="at">x=</span>mon_summary)   <span class="co"># Join with the mon_summary dataframe</span></span>
<span id="cb346-18"><a href="on-your-own-5.html#cb346-18" tabindex="-1"></a></span>
<span id="cb346-19"><a href="on-your-own-5.html#cb346-19" tabindex="-1"></a><span class="co"># We first need to convert the date column to a date object</span></span>
<span id="cb346-20"><a href="on-your-own-5.html#cb346-20" tabindex="-1"></a>mon_summary<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">ym</span>(mon_summary<span class="sc">$</span>date)</span>
<span id="cb346-21"><a href="on-your-own-5.html#cb346-21" tabindex="-1"></a></span>
<span id="cb346-22"><a href="on-your-own-5.html#cb346-22" tabindex="-1"></a><span class="co"># Set up a two panel plot (side by side)</span></span>
<span id="cb346-23"><a href="on-your-own-5.html#cb346-23" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb346-24"><a href="on-your-own-5.html#cb346-24" tabindex="-1"></a></span>
<span id="cb346-25"><a href="on-your-own-5.html#cb346-25" tabindex="-1"></a><span class="fu">plot</span>(mon_summary<span class="sc">$</span>date, mon_summary<span class="sc">$</span>locs_active,</span>
<span id="cb346-26"><a href="on-your-own-5.html#cb346-26" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;o&quot;</span>, </span>
<span id="cb346-27"><a href="on-your-own-5.html#cb346-27" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb346-28"><a href="on-your-own-5.html#cb346-28" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(mon_summary<span class="sc">$</span>locs_active)),</span>
<span id="cb346-29"><a href="on-your-own-5.html#cb346-29" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>, </span>
<span id="cb346-30"><a href="on-your-own-5.html#cb346-30" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Number of cameras active&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Date&quot;</span>)</span>
<span id="cb346-31"><a href="on-your-own-5.html#cb346-31" tabindex="-1"></a></span>
<span id="cb346-32"><a href="on-your-own-5.html#cb346-32" tabindex="-1"></a></span>
<span id="cb346-33"><a href="on-your-own-5.html#cb346-33" tabindex="-1"></a><span class="co"># Sum all the captures rates for the species columns</span></span>
<span id="cb346-34"><a href="on-your-own-5.html#cb346-34" tabindex="-1"></a>mon_summary<span class="sc">$</span>all.sp <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(mon_summary[, sp_summary<span class="sc">$</span>sp])</span>
<span id="cb346-35"><a href="on-your-own-5.html#cb346-35" tabindex="-1"></a></span>
<span id="cb346-36"><a href="on-your-own-5.html#cb346-36" tabindex="-1"></a><span class="co"># Plot them</span></span>
<span id="cb346-37"><a href="on-your-own-5.html#cb346-37" tabindex="-1"></a><span class="fu">plot</span>(mon_summary<span class="sc">$</span>date, mon_summary<span class="sc">$</span>all.sp<span class="sc">/</span>(mon_summary<span class="sc">$</span>cam_days<span class="sc">/</span><span class="dv">100</span>),</span>
<span id="cb346-38"><a href="on-your-own-5.html#cb346-38" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;o&quot;</span>,</span>
<span id="cb346-39"><a href="on-your-own-5.html#cb346-39" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb346-40"><a href="on-your-own-5.html#cb346-40" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&quot;Detections per 100 cam days&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Date&quot;</span>)</span></code></pre></div>
<p><strong>Question</strong> What is going on in these plots?</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb347-1"><a href="on-your-own-5.html#cb347-1" tabindex="-1"></a><span class="co"># Species specific plots</span></span>
<span id="cb347-2"><a href="on-your-own-5.html#cb347-2" tabindex="-1"></a></span>
<span id="cb347-3"><a href="on-your-own-5.html#cb347-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb347-4"><a href="on-your-own-5.html#cb347-4" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb347-5"><a href="on-your-own-5.html#cb347-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sp_summary<span class="sc">$</span>sp))</span>
<span id="cb347-6"><a href="on-your-own-5.html#cb347-6" tabindex="-1"></a>{</span>
<span id="cb347-7"><a href="on-your-own-5.html#cb347-7" tabindex="-1"></a>  <span class="fu">plot</span>(mon_summary<span class="sc">$</span>date, <span class="fu">pull</span>(mon_summary, sp_summary<span class="sc">$</span>sp[i])<span class="sc">/</span>(mon_summary<span class="sc">$</span>cam_days<span class="sc">/</span><span class="dv">100</span>),  <span class="co"># The pull command allows you to grab a specific column in a dataframe and turn it into a vector!</span></span>
<span id="cb347-8"><a href="on-your-own-5.html#cb347-8" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;o&quot;</span>,</span>
<span id="cb347-9"><a href="on-your-own-5.html#cb347-9" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">19</span>,</span>
<span id="cb347-10"><a href="on-your-own-5.html#cb347-10" tabindex="-1"></a>     <span class="at">las=</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&quot;Detections per 100 cam days&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Date&quot;</span>,</span>
<span id="cb347-11"><a href="on-your-own-5.html#cb347-11" tabindex="-1"></a>     <span class="at">main=</span>sp_summary<span class="sc">$</span>sp[i])</span>
<span id="cb347-12"><a href="on-your-own-5.html#cb347-12" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Question</strong> Any interesting patterns?</p>
</div>
<div id="spatial-patterns" class="section level3 hasAnchor" number="15.4.4">
<h3><span class="header-section-number">15.4.4</span> Spatial patterns<a href="on-your-own-5.html#spatial-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb348"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb348-1"><a href="on-your-own-5.html#cb348-1" tabindex="-1"></a><span class="co"># Spatial plots</span></span>
<span id="cb348-2"><a href="on-your-own-5.html#cb348-2" tabindex="-1"></a></span>
<span id="cb348-3"><a href="on-your-own-5.html#cb348-3" tabindex="-1"></a>total_obs <span class="ot">&lt;-</span> <span class="fu">left_join</span>(total_obs, locs)</span>
<span id="cb348-4"><a href="on-your-own-5.html#cb348-4" tabindex="-1"></a></span>
<span id="cb348-5"><a href="on-your-own-5.html#cb348-5" tabindex="-1"></a><span class="co"># Jaguar</span></span>
<span id="cb348-6"><a href="on-your-own-5.html#cb348-6" tabindex="-1"></a>focal_species <span class="ot">&lt;-</span> <span class="st">&quot;Panthera.onca&quot;</span></span>
<span id="cb348-7"><a href="on-your-own-5.html#cb348-7" tabindex="-1"></a></span>
<span id="cb348-8"><a href="on-your-own-5.html#cb348-8" tabindex="-1"></a>focal_cr <span class="ot">&lt;-</span> <span class="fu">pull</span>(total_obs, focal_species)<span class="sc">/</span>(total_obs<span class="sc">$</span>days<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb348-9"><a href="on-your-own-5.html#cb348-9" tabindex="-1"></a></span>
<span id="cb348-10"><a href="on-your-own-5.html#cb348-10" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb348-11"><a href="on-your-own-5.html#cb348-11" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>Esri.WorldTopoMap, <span class="at">group=</span><span class="st">&quot;Base&quot;</span>) <span class="sc">%&gt;%</span>     </span>
<span id="cb348-12"><a href="on-your-own-5.html#cb348-12" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng=</span>locs<span class="sc">$</span>longitude, <span class="at">lat=</span>locs<span class="sc">$</span>latitude,</span>
<span id="cb348-13"><a href="on-your-own-5.html#cb348-13" tabindex="-1"></a>                   <span class="co"># Add a popup of the deployment code </span></span>
<span id="cb348-14"><a href="on-your-own-5.html#cb348-14" tabindex="-1"></a>                   <span class="at">popup=</span><span class="fu">paste</span>(locs<span class="sc">$</span>placename),</span>
<span id="cb348-15"><a href="on-your-own-5.html#cb348-15" tabindex="-1"></a>                   <span class="at">radius=</span>(focal_cr<span class="sc">/</span><span class="fu">max</span>(focal_cr)<span class="sc">*</span><span class="dv">10</span>)<span class="sc">+</span><span class="dv">1</span>, <span class="at">stroke=</span>F,</span>
<span id="cb348-16"><a href="on-your-own-5.html#cb348-16" tabindex="-1"></a>                   <span class="at">fillOpacity=</span><span class="fl">0.6</span>) </span>
<span id="cb348-17"><a href="on-your-own-5.html#cb348-17" tabindex="-1"></a>m</span></code></pre></div>
<p>Try other species!</p>
<p><strong>Question</strong> Any interesting patterns?</p>
</div>
<div id="species-co-occurance" class="section level3 hasAnchor" number="15.4.5">
<h3><span class="header-section-number">15.4.5</span> Species co-occurance<a href="on-your-own-5.html#species-co-occurance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb349"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb349-1"><a href="on-your-own-5.html#cb349-1" tabindex="-1"></a><span class="co"># Co-occurances</span></span>
<span id="cb349-2"><a href="on-your-own-5.html#cb349-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb349-3"><a href="on-your-own-5.html#cb349-3" tabindex="-1"></a></span>
<span id="cb349-4"><a href="on-your-own-5.html#cb349-4" tabindex="-1"></a><span class="co"># Pull the data for each of the species from </span></span>
<span id="cb349-5"><a href="on-your-own-5.html#cb349-5" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> total_obs[, sp_summary<span class="sc">$</span>sp]</span>
<span id="cb349-6"><a href="on-your-own-5.html#cb349-6" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(tmp)</span>
<span id="cb349-7"><a href="on-your-own-5.html#cb349-7" tabindex="-1"></a></span>
<span id="cb349-8"><a href="on-your-own-5.html#cb349-8" tabindex="-1"></a><span class="fu">corrplot</span>(M, <span class="at">method=</span><span class="st">&quot;color&quot;</span>, </span>
<span id="cb349-9"><a href="on-your-own-5.html#cb349-9" tabindex="-1"></a>         <span class="at">type=</span><span class="st">&quot;upper&quot;</span>, </span>
<span id="cb349-10"><a href="on-your-own-5.html#cb349-10" tabindex="-1"></a>         <span class="at">order=</span><span class="st">&quot;hclust&quot;</span>,</span>
<span id="cb349-11"><a href="on-your-own-5.html#cb349-11" tabindex="-1"></a>         <span class="co"># addCoef.col = &quot;black&quot;, # We suppress the coefs to make a cleaner plot</span></span>
<span id="cb349-12"><a href="on-your-own-5.html#cb349-12" tabindex="-1"></a>         <span class="at">tl.col=</span><span class="st">&quot;black&quot;</span>, <span class="at">tl.srt=</span><span class="dv">45</span>, <span class="co">#Text label color and rotation</span></span>
<span id="cb349-13"><a href="on-your-own-5.html#cb349-13" tabindex="-1"></a>         <span class="at">diag=</span><span class="cn">FALSE</span></span>
<span id="cb349-14"><a href="on-your-own-5.html#cb349-14" tabindex="-1"></a>         )</span></code></pre></div>
<p><strong>Question</strong> Any interesting patterns?</p>
<p>You can now do some data exploration plots.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb350-1"><a href="on-your-own-5.html#cb350-1" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb350-2"><a href="on-your-own-5.html#cb350-2" tabindex="-1"></a>locs <span class="ot">&lt;-</span> locs <span class="sc">%&gt;%</span> </span>
<span id="cb350-3"><a href="on-your-own-5.html#cb350-3" tabindex="-1"></a>            <span class="fu">mutate_if</span>(is.character,as.factor) <span class="co"># If a column is a character string, make it a factor</span></span>
<span id="cb350-4"><a href="on-your-own-5.html#cb350-4" tabindex="-1"></a></span>
<span id="cb350-5"><a href="on-your-own-5.html#cb350-5" tabindex="-1"></a>total_obs <span class="ot">&lt;-</span> <span class="fu">left_join</span>(total_obs, locs)</span></code></pre></div>
<p>We have the following species:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb351-1"><a href="on-your-own-5.html#cb351-1" tabindex="-1"></a>sp_summary<span class="sc">$</span>sp</span></code></pre></div>
<p>And the following categories to explore:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r Rmain"><code class="sourceCode r"><span id="cb352-1"><a href="on-your-own-5.html#cb352-1" tabindex="-1"></a> <span class="fu">c</span>(<span class="st">&quot;feature_type&quot;</span>, <span class="st">&quot;elevation&quot;</span>, <span class="st">&quot;mean_ndvi&quot;</span>)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="behavior.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/12-on_your_own.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["WildCo: An Introduction to Camera Trap Data Management and Analysis in R.pdf", "WildCo: An Introduction to Camera Trap Data Management and Analysis in R.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
